<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Product Hunt" Id="ProductHunt" Category="Products &amp; Review Sites" RequireVersion="8.2" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/ProductHunt.xml" HelpUrl="http://seotoolsforexcel.com/producthunt/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/producthunt/">
    <Text Id="Token" Title="Token" Required="true" HelpUrl="http://seotoolsforexcel.com/producthunt/"/>
  </Settings>

  <Resources>
    <Resource Id="Sortings">
      <Item Id="created_at&amp;order=desc" Title="Created Desc"/>
      <Item Id="created_at&amp;order=asc" Title="Created Asc"/>
      <Item Id="updated_at&amp;order=desc" Title="Updated Desc"/>
      <Item Id="updated_at&amp;order=asc" Title="Updated Asc"/>
      <Item Id="id&amp;order=desc" Title="Id Desc"/>
      <Item Id="id&amp;order=asc" Title="Id Asc"/>
    </Resource>
    <Resource Id="HttpSettings">
      <HttpSettings>
				<RequestContentType>application/json</RequestContentType>
        <RequestHeaders>
          <Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Bearer @(Model.Token)</Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
    <Resource Id="Fail">
			<Fail>
				<JsonPath Expr="error_description"/>
			</Fail>
    </Resource>
  </Resources>

  <RestConnector Id="Posts" Title="Posts List" Group="Posts" HelpUrl="https://api.producthunt.com/v1/docs/posts/posts_all_get_the_latest_posts">
    <Parameters>
      <Text Id="TopicSearch" Title="Search by Topic" Debug.DefaultValue="" Required="false"/>
      <Text Id="CategorySearch" Title="Search by Category" Debug.DefaultValue="" Required="false"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
					<Item Id="votes_count&amp;order=desc" Title="Votes Desc"/>
					<Item Id="votes_count&amp;order=asc" Title="Votes Asc"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/posts/all
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        @(!string.IsNullOrEmpty(Model.TopicSearch) ? "&search[topic]=" + Utils.UrlEncode(Model.TopicSearch) : "")
        @(!string.IsNullOrEmpty(Model.CategorySearch) ? "&search[category]=" + Utils.UrlEncode(Model.CategorySearch) : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="posts.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="slug" Id="Slug" Title="Slug" Converter="String"/>
				<JsonPath Expr="name" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="tagline" Id="Tagline" Title="Tagline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="comments_count" Id="Comments" Title="Comments" Converter="Long"/>
				<JsonPath Expr="votes_count" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="product_state" Id="ProductState" Title="Product State" Converter="String"/>
				<JsonPath Expr="redirect_url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="discussion_url" Id="DiscussionUrl" Title="Discussion URL" Converter="String"/>
				<JsonPath Expr="topics[0].name" Id="Topic" Title="Topic" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PostsSpecificDay" Title="Posts Specific Day" Group="Posts" HelpUrl="https://api.producthunt.com/v1/docs/posts/posts_index_request_a_specific_day_with_the_%60day%60_parameter_(tech_category)">
    <Parameters>
      <Date Id="DisplayDate" Title="Day" Required="true" Nullable="false"/>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/posts
				?day=@Model.DisplayDate.ToString("yyyy-MM-dd")
				&page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="posts.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="slug" Id="Slug" Title="Slug" Converter="String"/>
				<JsonPath Expr="name" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="tagline" Id="Tagline" Title="Tagline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="comments_count" Id="Comments" Title="Comments" Converter="Long"/>
				<JsonPath Expr="votes_count" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="product_state" Id="ProductState" Title="Product State" Converter="String"/>
				<JsonPath Expr="redirect_url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="discussion_url" Id="DiscussionUrl" Title="Discussion URL" Converter="String"/>
				<JsonPath Expr="topics[0].name" Id="Topic" Title="Topic" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PostsLookup" Title="Posts Lookup" Group="Posts" HelpUrl="https://api.producthunt.com/v1/docs/posts/posts_show_get_details_of_a_post">
    <Parameters>
      <Text Id="PostId" Title="Post Id" Debug.DefaultValue="134228" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/posts/@(Model.PostId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="post">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="slug" Id="Slug" Title="Slug" Converter="String"/>
				<JsonPath Expr="name" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="tagline" Id="Tagline" Title="Tagline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="comments_count" Id="Comments" Title="Comments" Converter="Long"/>
				<JsonPath Expr="votes_count" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="product_state" Id="ProductState" Title="Product State" Converter="String"/>
				<JsonPath Expr="redirect_url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="discussion_url" Id="DiscussionUrl" Title="Discussion URL" Converter="String"/>
				<JsonPath Expr="topics[0].name" Id="Topic" Title="Topic" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PostsByUser" Title="Posts by User" Group="Posts" HelpUrl="https://api.producthunt.com/v1/docs/posts/posts_all_see_all_posts_created_by_a_user">
    <Parameters>
      <Text Id="UserId" Title="User Id" Debug.DefaultValue="72708" Required="true"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users/@(Model.UserId)/posts
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="posts.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="slug" Id="Slug" Title="Slug" Converter="String"/>
				<JsonPath Expr="name" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="tagline" Id="Tagline" Title="Tagline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="comments_count" Id="Comments" Title="Comments" Converter="Long"/>
				<JsonPath Expr="votes_count" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="product_state" Id="ProductState" Title="Product State" Converter="String"/>
				<JsonPath Expr="redirect_url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="discussion_url" Id="DiscussionUrl" Title="Discussion URL" Converter="String"/>
				<JsonPath Expr="topics[0].name" Id="Topic" Title="Topic" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Topics" Title="Topics" HelpUrl="https://api.producthunt.com/v1/docs/topics/topics_index_list_topics">
    <Parameters>
      <Text Id="SlugSearch" Title="Search by Slug" Debug.DefaultValue="" Required="false"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/topics
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        @(!string.IsNullOrEmpty(Model.SlugSearch) ? "&search[slug]=" + Utils.UrlEncode(Model.SlugSearch) : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="topics.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="slug" Id="Slug" Title="Slug" Converter="String"/>
				<JsonPath Expr="name" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="description" Id="Description" Title="Description" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="followers_count" Id="Followers" Title="Followers" Converter="Long"/>
				<JsonPath Expr="posts_count" Id="Posts" Title="Posts" Converter="Long"/>
				<JsonPath Expr="trending" Id="Trending" Title="Trending" Converter="Bool"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Users" Title="Users List" Group="Users" HelpUrl="https://api.producthunt.com/v1/docs/users/users_index_get_all_users">
    <Parameters>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="users.*">
				<JsonPath Expr="id" Id="UserId" Title="Id" Converter="Long"/>
				<JsonPath Expr="name" Id="UserFullName" Title="Full Name" Converter="String"/>
				<JsonPath Expr="username" Id="Username" Title="Username" Converter="String"/>
				<JsonPath Expr="headline" Id="Headline" Title="Headline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="twitter_username" Id="UsernameTwitter" Title="Twitter" Converter="String"/>
				<JsonPath Expr="website_url" Id="UserWebsite" Title="Website" Converter="String"/>
				<JsonPath Expr="profile_url" Id="UserProfile" Title="Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Users Lookup" Title="Users Lookup" Group="Users" HelpUrl="https://api.producthunt.com/v1/docs/users/users_show_get_details_of_a_user">
    <Parameters>
      <Text Id="UserId" Title="User Id" Debug.DefaultValue="72708" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users/@(Model.UserId)
				?exclude=relationships
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="user">
				<JsonPath Expr="id" Id="UserId" Title="Id" Converter="Long"/>
				<JsonPath Expr="name" Id="UserFullName" Title="Full Name" Converter="String"/>
				<JsonPath Expr="username" Id="Username" Title="Username" Converter="String"/>
				<JsonPath Expr="headline" Id="Headline" Title="Headline" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="posts_count" Id="Posts" Title="Posts" Converter="Long"/>
				<JsonPath Expr="votes_count" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="followers_count" Id="Followers" Title="Followers" Converter="Long"/>
				<JsonPath Expr="followings_count" Id="Followings" Title="Followings" Converter="Long"/>
				<JsonPath Expr="collections_count" Id="Collections" Title="Collections" Converter="Long"/>
				<JsonPath Expr="followed_topics_count" Id="FollowedTopics" Title="Followed Topics" Converter="Long"/>
				<JsonPath Expr="maker_of_count" Id="MakerOfCount" Title="Maker Of" Converter="Long"/>
				<JsonPath Expr="twitter_username" Id="UsernameTwitter" Title="Twitter" Converter="String"/>
				<JsonPath Expr="website_url" Id="UserWebsite" Title="Website" Converter="String"/>
				<JsonPath Expr="profile_url" Id="UserProfile" Title="Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Collections" Title="Collections List" Group="Collections" HelpUrl="https://api.producthunt.com/v1/docs/collections/collections_index_get_the_latest_collections">
    <Parameters>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/collections
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="collections.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="updated_at" Id="Updated" Title="Updated" Converter="DateTime"/>
				<JsonPath Expr="subscriber_count" Id="Subscribers" Title="Subscribers" Converter="Long"/>
				<JsonPath Expr="posts_count" Id="Posts" Title="Posts" Converter="Long"/>
				<JsonPath Expr="collection_url" Id="CollectionUrl" Title="Collection URL" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CollectionsByUser" Title="Collections by User" Group="Collections" HelpUrl="https://api.producthunt.com/v1/docs/collections/collections_index_see_all_collections_created_by_a_user">
    <Parameters>
      <Text Id="UserId" Title="User Id" Debug.DefaultValue="72708" Required="true"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users/@(Model.UserId)/collections
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="collections.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="updated_at" Id="Updated" Title="Updated" Converter="DateTime"/>
				<JsonPath Expr="subscriber_count" Id="Subscribers" Title="Subscribers" Converter="Long"/>
				<JsonPath Expr="posts_count" Id="Posts" Title="Posts" Converter="Long"/>
				<JsonPath Expr="collection_url" Id="CollectionUrl" Title="Collection URL" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CollectionsLookup" Title="Collections Lookup" Group="Collections" HelpUrl="https://api.producthunt.com/v1/docs/collections/collection_show_get_details_of_a_collection">
    <Parameters>
      <Text Id="CollectionId" Title="Collection Id" Debug.DefaultValue="147274" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/collections/@(Model.CollectionId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="collection">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="updated_at" Id="Updated" Title="Updated" Converter="DateTime"/>
				<JsonPath Expr="subscriber_count" Id="Subscribers" Title="Subscribers" Converter="Long"/>
				<JsonPath Expr="posts_count" Id="Posts" Title="Posts" Converter="Long"/>
				<JsonPath Expr="collection_url" Id="CollectionUrl" Title="Collection URL" Converter="String"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Comments" Title="Comments" HelpUrl="https://api.producthunt.com/v1/docs/comments_and_comment_threads/comments_index_get_the_latest_comments">
    <Parameters>
      <Text Id="UserIdSearch" Title="Search by User Id" Debug.DefaultValue="" Required="false"/>
      <Text Id="PostIdSearch" Title="Search by Post Id" Debug.DefaultValue="" Required="false"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/comments
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        @(!string.IsNullOrEmpty(Model.UserIdSearch) ? "&search[user_id]=" + Utils.UrlEncode(Model.UserIdSearch) : "")
        @(!string.IsNullOrEmpty(Model.PostIdSearch) ? "&search[post_id]=" + Utils.UrlEncode(Model.PostIdSearch) : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="comments.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long"/>
				<JsonPath Expr="body" Id="Body" Title="Body" Converter="String"/>
				<JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
				<JsonPath Expr="votes" Id="Votes" Title="Votes" Converter="Long"/>
				<JsonPath Expr="parent_comment_id" Id="ParentCommentId" Title="Parent Comment Id" Converter="Long"/>
				<JsonPath Expr="subject_type" Id="SubjectType" Title="Subject Type" Converter="String"/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String"/>
				<JsonPath Expr="post.id" Id="PostId" Title="Post Id" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="post.name" Id="PostName" Title="Post Name" Converter="String" DefaultValue=""/>
				<JsonPath Expr="post.tagline" Id="PostTagline" Title="Post Tagline" Converter="String" DefaultValue=""/>
				<JsonPath Expr="post.created_at" Id="PostCreated" Title="Post Created" Converter="Auto" DefaultValue=""/>
				<JsonPath Expr="post.comments_count" Id="PostComments" Title="Post Comments" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="post.url" Id="PostUrl" Title="Post URL" Converter="Long" DefaultValue=""/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Followers" Title="Followers" Group="Connections" HelpUrl="https://api.producthunt.com/v1/docs/followers_followings/followers_index_list_all_followers">
    <Parameters>
      <Text Id="UserId" Title="User Id" Debug.DefaultValue="72708" Required="true"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users/@(Model.UserId)/followers
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="followers.*">
				<JsonPath Expr="created_at" Id="Followed" Title="Followed At" Converter="DateTime"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Following" Title="Following" Group="Connections" HelpUrl="https://api.producthunt.com/v1/docs/followers_followings/followers_index_list_all_followers">
    <Parameters>
      <Text Id="UserId" Title="User Id" Debug.DefaultValue="72708" Required="true"/>
			<Select Id="Sorting" Title="Sort Results by" Required="false" DefaultValue="created_at&amp;sort_by=desc">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="50" EvenPages="true"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
				https://api.producthunt.com/v1/users/@(Model.UserId)/following
				?page=@(Model.PageCursor.Page+1)
				&per_page=@(Model.PageCursor.NextTake)
				&sort_by=@(Model.Sorting)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="following.*">
				<JsonPath Expr="created_at" Id="Followed" Title="Followed At" Converter="DateTime"/>
				<JsonPath Expr="user.id" Id="UserId" Title="User Id" Converter="Long"/>
				<JsonPath Expr="user.name" Id="UserFullName" Title="User Full Name" Converter="String"/>
				<JsonPath Expr="user.username" Id="Username" Title="User Username" Converter="String"/>
				<JsonPath Expr="user.twitter_username" Id="UsernameTwitter" Title="User Twitter" Converter="String"/>
				<JsonPath Expr="user.website_url" Id="UserWebsite" Title="User Website" Converter="String"/>
				<JsonPath Expr="user.profile_url" Id="UserProfile" Title="User Profile" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

</Suite>