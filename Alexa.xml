<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" RequireVersion="7.0.0" Title="Alexa" Id="Alexa" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Alexa.xml" HelpUrl="http://seotoolsforexcel.com/Alexa" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <RestConnector Id="Alexa" Title="Alexa">
    <Parameters>
      <Text Id="Url" Title="URL" Required="true" Debug.DefaultValue="http://www.seotoolsforexcel.com"/>
		</Parameters>
    <Fetch>
      <Fetch.Url>
			<![CDATA[
        https://www.alexa.com/siteinfo/@(Utils.UrlProperty(Model.Url).Domain)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Compute Id="GlobalRank" Title="Global Rank" Converter="Auto">
				<Compute.Expr>
					<![CDATA[
						@Regex.Replace(Model.Inp, @"[^0-9]+", "")
					]]>
				</Compute.Expr>
				<XPath Expr="//div[@@class='rank-global']//p[@@class='big data']" Id="Inp" DefaultValue=""/>
			</Compute>
      <XPath Expr="//*[text()='Bounce rate ']/../p/text()" Id="BounceRate" Title="Bounce Rate" Converter="Auto"/>
      <XPath Expr="//*[text()='Daily Pageviews per Visitor']/../p/text()" Id="PageViews" Title="Daily Page Views per Visitor" Converter="String"/>
      <XPath Expr="//*[text()='Daily Time on Site  ']/../p/text()" Id="TimeOnSite" Title="Daily Time on Site" Converter="String"/>
    </Parse>
  </RestConnector>

</Suite>