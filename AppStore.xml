<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="App Store" Identifier="AppStore" RequireVersion="7.0" Category="Shopping &amp; Review Sites" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/iTunes.xml" HelpUrl="http://seotoolsforexcel.com/iTunes/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Resources>
    <Resource Id="Medias">
      <Item Id="all" Title="All"/>
      <Item Id="movie" Title="Movie"/>
      <Item Id="podcast" Title="Podcast"/>
      <Item Id="music" Title="Music"/>
      <Item Id="musicVideo" Title="Music Video"/>
      <Item Id="audiobook" Title="Audio Book"/>
      <Item Id="shortFilm" Title="Short Film"/>
      <Item Id="tvShow" Title="TV Show"/>
      <Item Id="software" Title="Software"/>
      <Item Id="ebook" Title="eBook"/>
    </Resource>
    <Resource Id="Countries">
      <Item Id="AF" Title="Afghanistan"/>
      <Item Id="AL" Title="Albania"/>
      <Item Id="DZ" Title="Algeria"/>
      <Item Id="AO" Title="Angola"/>
      <Item Id="AR" Title="Argentina"/>
      <Item Id="AU" Title="Australia"/>
      <Item Id="AT" Title="Austria"/>
      <Item Id="AZ" Title="Azerbaijan"/>
      <Item Id="BH" Title="Bahrain"/>
      <Item Id="BD" Title="Bangladesh"/>
      <Item Id="BY" Title="Belarus"/>
      <Item Id="BE" Title="Belgium"/>
      <Item Id="BO" Title="Bolivia"/>
      <Item Id="BA" Title="Bosnia and Herzegovina"/>
      <Item Id="BW" Title="Botswana"/>
      <Item Id="BR" Title="Brazil"/>
      <Item Id="BG" Title="Bulgaria"/>
      <Item Id="BF" Title="Burkina Faso"/>
      <Item Id="KH" Title="Cambodia"/>
      <Item Id="CM" Title="Cameroon"/>
      <Item Id="CA" Title="Canada"/>
      <Item Id="CF" Title="Central Africa"/>
      <Item Id="TD" Title="Chad"/>
      <Item Id="CL" Title="Chile"/>
      <Item Id="CN" Title="China"/>
      <Item Id="CO" Title="Colombia"/>
      <Item Id="CG" Title="Congo"/>
      <Item Id="CR" Title="Costa Rica"/>
      <Item Id="HR" Title="Croatia"/>
      <Item Id="CU" Title="Cuba"/>
      <Item Id="CY" Title="Cyprus"/>
      <Item Id="CZ" Title="Czechia"/>
      <Item Id="CI" Title="CÃ´te d'Ivoire"/>
      <Item Id="DK" Title="Denmark"/>
      <Item Id="DO" Title="Dominican Republic"/>
      <Item Id="EC" Title="Ecuador"/>
      <Item Id="EG" Title="Egypt"/>
      <Item Id="SV" Title="El Salvador"/>
      <Item Id="EE" Title="Estonia"/>
      <Item Id="ET" Title="Ethiopia"/>
      <Item Id="FI" Title="Finland"/>
      <Item Id="FR" Title="France"/>
      <Item Id="GE" Title="Georgia"/>
      <Item Id="DE" Title="Germany"/>
      <Item Id="GH" Title="Ghana"/>
      <Item Id="GR" Title="Greece"/>
      <Item Id="GL" Title="Greenland"/>
      <Item Id="GT" Title="Guatemala"/>
      <Item Id="GN" Title="Guinea"/>
      <Item Id="GY" Title="Guyana"/>
      <Item Id="HT" Title="Haiti"/>
      <Item Id="HN" Title="Honduras"/>
      <Item Id="HK" Title="Hong Kong"/>
      <Item Id="HU" Title="Hungary"/>
      <Item Id="IS" Title="Iceland"/>
      <Item Id="IN" Title="India"/>
      <Item Id="ID" Title="Indonesia"/>
      <Item Id="IR" Title="Iran"/>
      <Item Id="IQ" Title="Iraq"/>
      <Item Id="IE" Title="Ireland"/>
      <Item Id="IL" Title="Israel"/>
      <Item Id="IT" Title="Italy"/>
      <Item Id="JM" Title="Jamaica"/>
      <Item Id="JP" Title="Japan"/>
      <Item Id="JO" Title="Jordan"/>
      <Item Id="KZ" Title="Kazakhstan"/>
      <Item Id="KE" Title="Kenya"/>
      <Item Id="KW" Title="Kuwait"/>
      <Item Id="LV" Title="Latvia"/>
      <Item Id="LB" Title="Lebanon"/>
      <Item Id="LR" Title="Liberia"/>
      <Item Id="LY" Title="Libya"/>
      <Item Id="LT" Title="Lithuania"/>
      <Item Id="LU" Title="Luxembourg"/>
      <Item Id="MK" Title="Macedonia"/>
      <Item Id="MG" Title="Madagascar"/>
      <Item Id="MW" Title="Malawi"/>
      <Item Id="MY" Title="Malaysia"/>
      <Item Id="ML" Title="Mali"/>
      <Item Id="MT" Title="Malta"/>
      <Item Id="MX" Title="Mexico"/>
      <Item Id="MD" Title="Moldova"/>
      <Item Id="MC" Title="Monaco"/>
      <Item Id="MN" Title="Mongolia"/>
      <Item Id="ME" Title="Montenegro"/>
      <Item Id="MA" Title="Morocco"/>
      <Item Id="MZ" Title="Mozambique"/>
      <Item Id="MM" Title="Myanmar"/>
      <Item Id="NA" Title="Namibia"/>
      <Item Id="NP" Title="Nepal"/>
      <Item Id="NL" Title="Netherlands"/>
      <Item Id="NZ" Title="New Zealand"/>
      <Item Id="NI" Title="Nicaragua"/>
      <Item Id="NE" Title="Niger"/>
      <Item Id="NG" Title="Nigeria"/>
      <Item Id="NO" Title="Norway"/>
      <Item Id="OM" Title="Oman"/>
      <Item Id="PK" Title="Pakistan"/>
      <Item Id="PS" Title="Palestine"/>
      <Item Id="PA" Title="Panama"/>
      <Item Id="PY" Title="Paraguay"/>
      <Item Id="PE" Title="Peru"/>
      <Item Id="PH" Title="Philippines"/>
      <Item Id="PL" Title="Poland"/>
      <Item Id="PT" Title="Portugal"/>
      <Item Id="PR" Title="Puerto Rico"/>
      <Item Id="QA" Title="Qatar"/>
      <Item Id="RO" Title="Romania"/>
      <Item Id="RU" Title="Russia"/>
      <Item Id="RW" Title="Rwanda"/>
      <Item Id="SA" Title="Saudi Arabia"/>
      <Item Id="SN" Title="Senegal"/>
      <Item Id="RS" Title="Serbia"/>
      <Item Id="SL" Title="Sierra Leone"/>
      <Item Id="SG" Title="Singapore"/>
      <Item Id="SK" Title="Slovakia"/>
      <Item Id="SI" Title="Slovenia"/>
      <Item Id="SO" Title="Somalia"/>
      <Item Id="ZA" Title="South Africa"/>
      <Item Id="KR" Title="Korea"/>
      <Item Id="ES" Title="Spain"/>
      <Item Id="LK" Title="Sri Lanka"/>
      <Item Id="SD" Title="Sudan"/>
      <Item Id="SE" Title="Sweden"/>
      <Item Id="CH" Title="Switzerland"/>
      <Item Id="SY" Title="Syria"/>
      <Item Id="TW" Title="Taiwan"/>
      <Item Id="TZ" Title="Tanzania"/>
      <Item Id="TH" Title="Thailand"/>
      <Item Id="TN" Title="Tunisia"/>
      <Item Id="TR" Title="Turkey"/>
      <Item Id="TM" Title="Turkmenistan"/>
      <Item Id="UG" Title="Uganda"/>
      <Item Id="UA" Title="Ukraine"/>
      <Item Id="AE" Title="United Arab Emirates"/>
      <Item Id="GB" Title="United Kingdom"/>
      <Item Id="US" Title="USA"/>
      <Item Id="UY" Title="Uruguay"/>
      <Item Id="UZ" Title="Uzbekistan"/>
      <Item Id="VE" Title="Venezuela"/>
      <Item Id="VN" Title="Viet Nam"/>
      <Item Id="YE" Title="Yemen"/>
      <Item Id="ZM" Title="Zambia"/>
      <Item Id="ZW" Title="Zimbabwe"/>
    </Resource>
  </Resources>

  <RestConnector Title="Reviews" Id="Reviews">
    <Parameters>
      <Text Id="AppId" Title="App Id" Required="true" Debug.DefaultValue="343200656"/>
      <Select Id="Country" Title="Country Store" Required="true" DefaultValue="US">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>
      <Radio Id="Sort" Title="Sort" DefaultValue="mostRecent">
        <DataSource>
          <Item Id="mostRecent" Title="Recent" />
          <Item Id="mostHelpful" Title="Helpful" />
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="50" EvenPages="false"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
          https://itunes.apple.com/@(Model.Country)/rss/customerreviews
					/id=@(Model.AppId)
					/page=@(Model.PageCursor.Page+1)
					/sortBy=@(Model.Sort)
					/json
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="feed.entry[1:-1:1]">
        <JsonPath Expr="id.label" Id="Id" Title="Id" Converter="String" DefaultValue=""/>
        <JsonPath Expr="title.label" Id="Title" Title="Title" Converter="String" DefaultValue=""/>
        <JsonPath Expr="content.label" Id="Content" Title="Content" Converter="String" DefaultValue=""/>
        <JsonPath Expr="im:rating.label" Id="Rating" Title="Rating" Converter="Long" DefaultValue=""/>
        <JsonPath Expr="author.name.label" Id="Author" Title="Author" Converter="String" DefaultValue=""/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RestConnector Title="Search Autocomplete " Id="SearchAutocomplete">
    <Parameters>
      <Text Id="Query" Title="Query" Required="true" Debug.DefaultValue="rock"/>
      <Select Id="Media" Title="Filter by Media Type" Required="false" DefaultValue="all">
        <DataSource>
          <Resource Id="Medias"/>
        </DataSource>
      </Select>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
				https://search.itunes.apple.com/WebObjects/MZSearchHints.woa/wa/hints
				?q=@(Utils.UrlEncode(Model.Query))
				@if(Model.Media != "all")
				{
					@: &media=@(Model.Media)
				}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <XPath Expr="//dict/array/dict">
        <XPath Expr="string[1]" Id="Term" Title="Term" Converter="String" DefaultValue=""/>
        <XPath Expr="integer" Id="Priority" Title="Priority" Converter="Long" DefaultValue=""/>
      </XPath>
    </Parse>
  </RestConnector>

</Suite>