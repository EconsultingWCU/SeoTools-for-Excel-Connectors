<?xml version="1.0" encoding="utf-8" ?>
<Suite RequireVersion="6.0" Title="Datagnion" Id="Datagnion" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Serpstat.xml" HelpUrl="http://seotoolsforexcel.com/Serpstat/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/Serpstat/">
    <Text Id="AccessKey" Title="Access Key" Required="true"/>
  </Settings>

  <Resources>
    <Resource Id="Languages">
	  <Item Id="ar" Title="Arabic"/>
	  <Item Id="bg" Title="Bulgarian"/>
	  <Item Id="cs" Title="Czech"/>
	  <Item Id="da" Title="Danish"/>
	  <Item Id="de" Title="German"/>
	  <Item Id="en" Title="English"/>
	  <Item Id="es" Title="Spanish"/>
	  <Item Id="et" Title="Estonian"/>
	  <Item Id="fa" Title="Persian"/>
	  <Item Id="fi" Title="Finnish"/>
	  <Item Id="fr" Title="French"/>
	  <Item Id="hi" Title="Hindi"/>
	  <Item Id="hr" Title="Croatian"/>
	  <Item Id="hu" Title="Hungarian"/>
	  <Item Id="id" Title="Indonesian"/>
	  <Item Id="it" Title="Italian"/>
	  <Item Id="ja" Title="Japanese"/>
	  <Item Id="ko" Title="Korean"/>
	  <Item Id="lt" Title="Lithuanian"/>
	  <Item Id="lv" Title="Latvian"/>
	  <Item Id="mk" Title="Macedonian"/>
	  <Item Id="nl" Title="Dutch"/>
	  <Item Id="no" Title="Norwegian"/>
	  <Item Id="pl" Title="Polish"/>
	  <Item Id="pt" Title="Portuguese"/>
	  <Item Id="ro" Title="Romanian"/>
	  <Item Id="ru" Title="Russian"/>
	  <Item Id="sk" Title="Slovak"/>
	  <Item Id="sl" Title="Slovene"/>
	  <Item Id="sv" Title="Swedish"/>
	  <Item Id="th" Title="Thai"/>
	  <Item Id="tr" Title="Turkish"/>
	  <Item Id="uk" Title="Ukrainian"/>
	  <Item Id="vi" Title="Vietnamese"/>
	  <Item Id="zh" Title="Chinese"/>
    </Resource>
    <Resource Id="Countries">
	  <Item Id="af" Title="Afghanistan"/>
	  <Item Id="al" Title="Albania"/>
	  <Item Id="dz" Title="Algeria"/>
	  <Item Id="ao" Title="Angola"/>
	  <Item Id="ar" Title="Argentina"/>
	  <Item Id="au" Title="Australia"/>
	  <Item Id="at" Title="Austria"/>
	  <Item Id="az" Title="Azerbaijan"/>
	  <Item Id="bh" Title="Bahrain"/>
	  <Item Id="bd" Title="Bangladesh"/>
	  <Item Id="by" Title="Belarus"/>
	  <Item Id="be" Title="Belgium"/>
	  <Item Id="bo" Title="Bolivia"/>
	  <Item Id="ba" Title="Bosnia and Herzegovina"/>
	  <Item Id="bw" Title="Botswana"/>
	  <Item Id="br" Title="Brazil"/>
	  <Item Id="bg" Title="Bulgaria"/>
	  <Item Id="bf" Title="Burkina Faso"/>
	  <Item Id="kh" Title="Cambodia"/>
	  <Item Id="cm" Title="Cameroon"/>
	  <Item Id="ca" Title="Canada"/>
	  <Item Id="cf" Title="Central Africa"/>
	  <Item Id="td" Title="Chad"/>
	  <Item Id="cl" Title="Chile"/>
	  <Item Id="cn" Title="China"/>
	  <Item Id="co" Title="Colombia"/>
	  <Item Id="cg" Title="Congo"/>
	  <Item Id="cr" Title="Costa Rica"/>
	  <Item Id="hr" Title="Croatia"/>
	  <Item Id="cu" Title="Cuba"/>
	  <Item Id="cy" Title="Cyprus"/>
	  <Item Id="cz" Title="Czechia"/>
	  <Item Id="ci" Title="Côte d'Ivoire"/>
	  <Item Id="dk" Title="Denmark"/>
	  <Item Id="do" Title="Dominican Republic"/>
	  <Item Id="ec" Title="Ecuador"/>
	  <Item Id="eg" Title="Egypt"/>
	  <Item Id="sv" Title="El Salvador"/>
	  <Item Id="ee" Title="Estonia"/>
	  <Item Id="et" Title="Ethiopia"/>
	  <Item Id="fi" Title="Finland"/>
	  <Item Id="fr" Title="France"/>
	  <Item Id="ge" Title="Georgia"/>
	  <Item Id="de" Title="Germany"/>
	  <Item Id="gh" Title="Ghana"/>
	  <Item Id="gr" Title="Greece"/>
	  <Item Id="gl" Title="Greenland"/>
	  <Item Id="gt" Title="Guatemala"/>
	  <Item Id="gn" Title="Guinea"/>
	  <Item Id="gy" Title="Guyana"/>
	  <Item Id="ht" Title="Haiti"/>
	  <Item Id="hn" Title="Honduras"/>
	  <Item Id="hk" Title="Hong Kong"/>
 	  <Item Id="hu" Title="Hungary"/>
	  <Item Id="is" Title="Iceland"/>
	  <Item Id="in" Title="India"/>
	  <Item Id="id" Title="Indonesia"/>
	  <Item Id="ir" Title="Iran"/>
	  <Item Id="iq" Title="Iraq"/>
	  <Item Id="ie" Title="Ireland"/>
	  <Item Id="il" Title="Israel"/>
	  <Item Id="it" Title="Italy"/>
	  <Item Id="jm" Title="Jamaica"/>
	  <Item Id="jp" Title="Japan"/>
	  <Item Id="jo" Title="Jordan"/>
	  <Item Id="kz" Title="Kazakhstan"/>
	  <Item Id="ke" Title="Kenya"/>
	  <Item Id="kw" Title="Kuwait"/>
	  <Item Id="lv" Title="Latvia"/>
	  <Item Id="lb" Title="Lebanon"/>
	  <Item Id="lr" Title="Liberia"/>
	  <Item Id="ly" Title="Libya"/>
	  <Item Id="lt" Title="Lithuania"/>
	  <Item Id="lu" Title="Luxembourg"/>
	  <Item Id="mk" Title="Macedonia"/>
	  <Item Id="mg" Title="Madagascar"/>
	  <Item Id="mw" Title="Malawi"/>
	  <Item Id="my" Title="Malaysia"/>
	  <Item Id="ml" Title="Mali"/>
	  <Item Id="mt" Title="Malta"/>
	  <Item Id="mx" Title="Mexico"/>
	  <Item Id="md" Title="Moldova"/>
	  <Item Id="mc" Title="Monaco"/>
	  <Item Id="mn" Title="Mongolia"/>
	  <Item Id="me" Title="Montenegro"/>
	  <Item Id="ma" Title="Morocco"/>
	  <Item Id="mz" Title="Mozambique"/>
	  <Item Id="mm" Title="Myanmar"/>
	  <Item Id="na" Title="Namibia"/>
	  <Item Id="np" Title="Nepal"/>
	  <Item Id="nl" Title="Netherlands"/>
	  <Item Id="nz" Title="New Zealand"/>
	  <Item Id="ni" Title="Nicaragua"/>
	  <Item Id="ne" Title="Niger"/>
	  <Item Id="ng" Title="Nigeria"/>
	  <Item Id="no" Title="Norway"/>
	  <Item Id="om" Title="Oman"/>
	  <Item Id="pk" Title="Pakistan"/>
	  <Item Id="ps" Title="Palestine"/>
	  <Item Id="pa" Title="Panama"/>
	  <Item Id="py" Title="Paraguay"/>
	  <Item Id="pe" Title="Peru"/>
	  <Item Id="ph" Title="Philippines"/>
	  <Item Id="pl" Title="Poland"/>
	  <Item Id="pt" Title="Portugal"/>
	  <Item Id="pr" Title="Puerto Rico"/>
	  <Item Id="qa" Title="Qatar"/>
	  <Item Id="ro" Title="Romania"/>
	  <Item Id="ru" Title="Russia"/>
	  <Item Id="rw" Title="Rwanda"/>
	  <Item Id="sa" Title="Saudi Arabia"/>
	  <Item Id="sn" Title="Senegal"/>
	  <Item Id="rs" Title="Serbia"/>
	  <Item Id="sl" Title="Sierra Leone"/>
	  <Item Id="sg" Title="Singapore"/>
	  <Item Id="sk" Title="Slovakia"/>
	  <Item Id="si" Title="Slovenia"/>
	  <Item Id="so" Title="Somalia"/>
	  <Item Id="za" Title="South Africa"/>
	  <Item Id="kr" Title="Korea"/>
	  <Item Id="es" Title="Spain"/>
	  <Item Id="lk" Title="Sri Lanka"/>
	  <Item Id="sd" Title="Sudan"/>
	  <Item Id="se" Title="Sweden"/>
	  <Item Id="ch" Title="Switzerland"/>
	  <Item Id="sy" Title="Syria"/>
	  <Item Id="tw" Title="Taiwan"/>
	  <Item Id="tz" Title="Tanzania"/>
	  <Item Id="th" Title="Thailand"/>
	  <Item Id="tn" Title="Tunisia"/>
	  <Item Id="tr" Title="Turkey"/>
	  <Item Id="tm" Title="Turkmenistan"/>
	  <Item Id="ug" Title="Uganda"/>
	  <Item Id="ua" Title="Ukraine"/>
	  <Item Id="ae" Title="United Arab Emirates"/>
	  <Item Id="gb" Title="United Kingdom"/>
	  <Item Id="us" Title="AUSA"/>
	  <Item Id="uy" Title="Uruguay"/>
	  <Item Id="uz" Title="Uzbekistan"/>
	  <Item Id="ve" Title="Venezuela"/>
	  <Item Id="vn" Title="Viet Nam"/>
	  <Item Id="ye" Title="Yemen"/>
	  <Item Id="zm" Title="Zambia"/>
	  <Item Id="zw" Title="Zimbabwe"/>
    </Resource>	
  </Resources>  
  
  <RestConnector Id="Search" Title="Search">
    <Parameters>
      <Text Id="AllWords" Title="All These Words" Debug.DefaultValue="birkenstock" Required="false"/>
      <Text Id="OneOrMore" Title="One or More" Debug.DefaultValue="" Required="false"/>
      <Text Id="Without" Title="Without" Debug.DefaultValue="" Required="false"/>
      <Select Id="Language" Title="Language" Required="true" DefaultValue="">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Languages"/>
        </DataSource>
      </Select>
      <Select Id="Country" Title="Country" Required="true" DefaultValue="no">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>		  
    </Parameters>
    <Paging PageSize="200" EvenPages="false">
      <Parse>
        <JsonPath Id="NextParse" Expr="paging.next"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        @if(Model.PageCursor.Page == 0)
        {
					@: https://socialsearch.datagnion.com/api/v1.4/search?apikey=@(Model.AccessKey)&scope=posting
					@if(Model.AllWords != "")
					{
						@: &all=@(Utils.UrlEncode(Model.AllWords))
					}
					@if(Model.OneOrMore != "")
					{
						@: &one=@(Utils.UrlEncode(Model.OneOrMore))
					}
					@if(Model.Without != "")
					{
						@: &none=@(Utils.UrlEncode(Model.Without))
					}
					@if(Model.Language != "")
					{
						@: &lang=@(Model.Language)
					}
					@if(Model.Country != "")
					{
						@: &country=@(Model.Country)
					}
					@: &period=month&time_base=created&sort=time&tz=Europe%2FStockholm&size=@(Model.PageCursor.NextTake)
				}
				else if(Model.NextParse is string && !Model.PageCursor.Page == 0)
				{
					@(Model.NextParse)
				}
				]]>
      </Fetch.Url>  
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">		  
        <JsonPath Expr="post.url" Id="Url" Title="URL" Converter="String"/>
      </JsonPath>		
      <JsonPath Expr="data.*">	
        <JsonPath Expr="id" Id="PostId" Title="Post Id" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data.*">
        <Compute Id="IdFull" Title="IdFull">
          <Compute.Expr>
            @(Model.AuthorId)_@(Model.PostId)
          </Compute.Expr>
			<JsonPath Expr="id" Id="PostId" Title="Post Id" Converter="String"/>
			<JsonPath Expr="post.author.id" Id="AuthorId" Converter="String"/>		
		  </Compute>
		</JsonPath>		  
      <JsonPath Expr="data[*].post">
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String"/>	  
        <JsonPath Expr="created_at" Id="Date" Title="Date" Converter="DateTime"/>
        <JsonPath Expr="message" Id="Message" Title="Message" Converter="String" Checked="true"/>	
        <JsonPath Expr="attached_link" Id="AttachedUrl" Title="Attached URL" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="data.*">	  
        <JsonPath Expr="enrichments.attached_link_info.title" Id="AttachedTitle" Title="Attached Title" Converter="String" Checked="true"/>
        <JsonPath Expr="enrichments.attached_link_info.description" Id="AttachedDescription" Title="Attached Description" Converter="String" Checked="true"/>	
        <JsonPath Expr="enrichments.social_stats.likes.count" Id="Likes" Title="Likes" Converter="Int"/>
        <JsonPath Expr="enrichments.social_stats.comments.count" Id="Comments" Title="Comments" Converter="Int"/>
        <JsonPath Expr="enrichments.social_stats.shares.count" Id="Shares" Title="Shares" Converter="Int"/>	
      </JsonPath>
      <JsonPath Expr="data[*].post.author">
        <JsonPath Expr="id" Id="AuthorId" Title="Author Id" Converter="String"/>	  
	    <JsonPath Expr="name" Id="Author" Title="Author" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data[*].post.author">
        <Compute Id="AuthorUrl" Title="AuthorURL">
          <Compute.Expr>
            https://www.facebook.com/@(Model.AuthorId)/
          </Compute.Expr>
          <JsonPath Expr="id" Id="AuthorId" Converter="String"/>
        </Compute>
		</JsonPath>				
      <JsonPath Expr="data[*].post.author">
        <JsonPath Expr="picture_url" Id="AuthorAvatar" Title="AuthorAvatar" Converter="String"/>
      </JsonPath>		
      <JsonPath Expr="data[*].post.page">
        <JsonPath Expr="id" Id="PageId" Title="Page Id" Converter="String"/>	  
	    <JsonPath Expr="name" Id="Page" Title="Page" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data[*].post.page">
        <Compute Id="PageUrl" Title="PageURL">
          <Compute.Expr>
            https://www.facebook.com/@(Model.PageId)/
          </Compute.Expr>
          <JsonPath Expr="id" Id="PageId" Converter="String"/>
        </Compute>
		</JsonPath>
      <JsonPath Expr="data[*].post.page">		
        <JsonPath Expr="country.name" Id="Country" Title="Country" Converter="String"/>
        <JsonPath Expr="picture_url" Id="PageAvatar" Title="PageAvatar" Converter="String"/>		
      </JsonPath>
      <JsonPath Expr="data.*">
        <JsonPath Expr="enrichments.category.name" Id="PageCategory" Title="Page Category" Converter="String"/>	  
      </JsonPath>
    </Parse>
  </RestConnector>
  
  <RestConnector Id="SearchLinks" Title="SearchLinks">
    <Parameters>
      <Text Id="AllWords" Title="All These Words" Debug.DefaultValue="hej" Required="false"/>
      <Text Id="OneOrMore" Title="One or More" Debug.DefaultValue="" Required="false"/>
      <Text Id="Without" Title="Without" Debug.DefaultValue="" Required="false"/>
      <Select Id="Language" Title="Language" Required="true" DefaultValue="">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Languages"/>
        </DataSource>
      </Select>
      <Select Id="Country" Title="Country" Required="true" DefaultValue="">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>		  
    </Parameters>
    <Paging PageSize="200" EvenPages="false">
      <Parse>
        <JsonPath Id="MaxTime" Expr="paging.next"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        @if(Model.PageCursor.Page == 0)
        {
		  @: https://socialsearch.datagnion.com/api/v1.4/search?apikey=@(Model.AccessKey)&scope=post_attached_link
			@if(Model.AllWords != "")
			{
			  @: &all=@(Utils.UrlEncode(Model.AllWords))
			}
			@if(Model.OneOrMore != "")
			{
			  @: &one=@(Utils.UrlEncode(Model.OneOrMore))
			}
			@if(Model.Without != "")
			{
			  @: &none=@(Utils.UrlEncode(Model.Without))
			}
			@if(Model.Language != "")
			{
			  @: &lang=@(Model.Language)
			}
			@if(Model.Country != "")
			{
			  @: &country=@(Model.Country)
			}			
		  @: &period=month&time_base=created&sort=time&tz=Europe%2FStockholm&size=@(Model.PageCursor.NextTake)
		}
		else
		{
			@(Model.MaxTime)
    }
		]]>
      </Fetch.Url>  
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">		  
        <JsonPath Expr="post.url" Id="Url" Title="URL" Converter="String"/>
      </JsonPath>		
      <JsonPath Expr="data.*">	
        <JsonPath Expr="id" Id="PostId" Title="Post Id" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data.*">
        <Compute Id="IdFull" Title="IdFull">
          <Compute.Expr>
            @(Model.AuthorId)_@(Model.PostId)
          </Compute.Expr>
			<JsonPath Expr="id" Id="PostId" Title="Post Id" Converter="String"/>
			<JsonPath Expr="post.author.id" Id="AuthorId" Converter="String"/>		
		  </Compute>
		</JsonPath>		  
      <JsonPath Expr="data[*].post">
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String"/>	  
        <JsonPath Expr="created_at" Id="Date" Title="Date" Converter="DateTime"/>
        <JsonPath Expr="message" Id="Message" Title="Message" Converter="String" Checked="true"/>	
        <JsonPath Expr="attached_link" Id="AttachedUrl" Title="Attached URL" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="data.*">	  
        <JsonPath Expr="enrichments.attached_link_info.title" Id="AttachedTitle" Title="Attached Title" Converter="String" Checked="true"/>
        <JsonPath Expr="enrichments.attached_link_info.description" Id="AttachedDescription" Title="Attached Description" Converter="String" Checked="true"/>	
        <JsonPath Expr="enrichments.social_stats.likes.count" Id="Likes" Title="Likes" Converter="Int"/>
        <JsonPath Expr="enrichments.social_stats.comments.count" Id="Comments" Title="Comments" Converter="Int"/>
        <JsonPath Expr="enrichments.social_stats.shares.count" Id="Shares" Title="Shares" Converter="Int"/>	
      </JsonPath>
      <JsonPath Expr="data[*].post.author">
        <JsonPath Expr="id" Id="AuthorId" Title="Author Id" Converter="String"/>	  
	    <JsonPath Expr="name" Id="Author" Title="Author" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data[*].post.author">
        <Compute Id="AuthorUrl" Title="AuthorURL">
          <Compute.Expr>
            https://www.facebook.com/@(Model.AuthorId)/
          </Compute.Expr>
          <JsonPath Expr="id" Id="AuthorId" Converter="String"/>
        </Compute>
		</JsonPath>				
      <JsonPath Expr="data[*].post.author">
        <JsonPath Expr="picture_url" Id="AuthorAvatar" Title="AuthorAvatar" Converter="String"/>
      </JsonPath>		
      <JsonPath Expr="data[*].post.page">
        <JsonPath Expr="id" Id="PageId" Title="Page Id" Converter="String"/>	  
	    <JsonPath Expr="name" Id="Page" Title="Page" Converter="String"/>
      </JsonPath>		
		<JsonPath Expr="data[*].post.page">
        <Compute Id="PageUrl" Title="PageURL">
          <Compute.Expr>
            https://www.facebook.com/@(Model.PageId)/
          </Compute.Expr>
          <JsonPath Expr="id" Id="PageId" Converter="String"/>
        </Compute>
		</JsonPath>
      <JsonPath Expr="data[*].post.page">		
        <JsonPath Expr="country.name" Id="Country" Title="Country" Converter="String"/>
        <JsonPath Expr="picture_url" Id="PageAvatar" Title="PageAvatar" Converter="String"/>		
      </JsonPath>
      <JsonPath Expr="data.*">
        <JsonPath Expr="enrichments.category.name" Id="PageCategory" Title="Page Category" Converter="String"/>	  
      </JsonPath>
    </Parse>	  
  </RestConnector>  
	
  <RestConnector Id="SearchComments" Title="SearchComments">
    <Parameters>
      <Text Id="AllWords" Title="All These Words" Debug.DefaultValue="aftonbladet" Required="false"/>
      <Text Id="OneOrMore" Title="One or More" Debug.DefaultValue="" Required="false"/>
      <Text Id="Without" Title="Without" Debug.DefaultValue="" Required="false"/>
      <Select Id="Language" Title="Language" Required="true" DefaultValue="">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Languages"/>
        </DataSource>
      </Select>
      <Select Id="Country" Title="Country" Required="true" DefaultValue="">
        <DataSource>
          <Item Id="" Title="All"/>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>		  
    </Parameters>
    <Paging PageSize="200" EvenPages="false">
      <Parse>
        <JsonPath Id="MaxTime" Expr="paging.next"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        @if(Model.PageCursor.Page == 0)
        {
		  @: https://socialsearch.datagnion.com/api/v1.4/search?apikey=@(Model.AccessKey)&scope=comment
			@if(Model.AllWords != "")
			{
			  @: &all=@(Utils.UrlEncode(Model.AllWords))
			}
			@if(Model.OneOrMore != "")
			{
			  @: &one=@(Utils.UrlEncode(Model.OneOrMore))
			}
			@if(Model.Without != "")
			{
			  @: &none=@(Utils.UrlEncode(Model.Without))
			}
			@if(Model.Language != "")
			{
			  @: &lang=@(Model.Language)
			}
			@if(Model.Country != "")
			{
			  @: &country=@(Model.Country)
			}			
		  @: &period=month&time_base=created&sort=time&tz=Europe%2FStockholm&size=@(Model.PageCursor.NextTake)
		}
		else
		{
		@(Model.MaxTime)
    }
		]]>
      </Fetch.Url>  
    </Fetch>
    <Parse>
			<JsonPath Expr="data[*]">
				<JsonPath Expr="id" Id="PostId" Title="PostId" Converter="String"/>
			</JsonPath>		
			<JsonPath Expr="data[*].post">
				<JsonPath Expr="comments" Id="CommentArray" Title="CommentArray" Converter="String"/>
			</JsonPath>
    </Parse>
  </RestConnector>

</Suite>