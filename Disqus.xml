<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="Social" RequireVersion="7.0.0" Title="Disqus" Id="Disqus" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Disqus.xml" HelpUrl="http://seotoolsforexcel.com/Disqus/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/Disqus/">
    <Text Id="Token" Title="Access Token" Required="true"/>
    <Text Id="Key" Title="API Key" Required="true"/>
    <Text Id="Secret" Title="API Secret" Required="true"/>
  </Settings>

  <RestConnector Id="PostDetails" Title="Post Details" HelpUrl="https://disqus.com/api/docs/posts/details/">
    <Parameters>
      <Text Id="PostId" Title="Post Id" Debug.DefaultValue="2541231971" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
					https://disqus.com/api/3.0/posts/details.json?
					post=@(Model.PostId)
					&access_token=@(Model.Token)
					&api_key=@(Model.Key)
					&api_secret=@(Model.Secret)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response">
        <JsonPath Expr="createdAt" Id="Created" Title="Created" Converter="DateTime"/>
        <JsonPath Expr="likes" Id="Likes" Title="Likes" Converter="Int"/>
        <JsonPath Expr="dislikes" Id="Dislikes" Title="Dislikes" Converter="Int"/>
        <JsonPath Expr="numReports" Id="Reports" Title="Reports" Converter="Int"/>
        <JsonPath Expr="points" Id="Points" Title="Points" Converter="Int"/>
        <JsonPath Expr="thread" Id="ThreadId" Title="Thread Id" Converter="String"/>
        <JsonPath Expr="userScore" Id="UserScore" Title="User Score" Converter="Int"/>
        <JsonPath Expr="author.id" Id="UserId" Title="User Id" Converter="String"/>
        <JsonPath Expr="author.username" Id="Username" Title="Username" Converter="String"/>
        <JsonPath Expr="author.name" Id="Name" Title="Name" Converter="String"/>
        <JsonPath Expr="author.rep" Id="Reputation" Title="Reputation" Converter="Double"/>
        <JsonPath Expr="author.reputationLabel" Id="ReputationLevel" Title="ReputationLevel" Converter="String"/>
        <JsonPath Expr="author.profileUrl" Id="ProfileUrl" Title="Profile URL" Converter="String"/>
        <JsonPath Expr="author.location" Id="Location" Title="Location" Converter="String"/>
        <JsonPath Expr="author.joinedAt" Id="Joined" Title="Joined" Converter="DateTime"/>
        <JsonPath Expr="author.avatar.small.permalink" Id="Avatar" Title="Avatar" Converter="String"/>
        <JsonPath Expr="forum" Id="Forum" Title="Forum" Converter="String"/>
      </JsonPath>
    </Parse>
      <Fail>
        <JsonPath Expr="message"/>
      </Fail>
  </RestConnector>

</Suite>