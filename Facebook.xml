<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Facebook" RequireVersion="5.2.6" Id="Facebook" Category="Social" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Facebook.xml" HelpUrl="http://seotoolsforexcel.com/facebook/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <DefaultOAuthAuthenticator StayAuthenticated="true" TokenName="access_token" AuthUrl="https://www.facebook.com/v2.8/dialog/oauth?client_id=756579344523803&amp;response_type=token&amp;scope=manage_pages&amp;redirect_uri={0}"/>

  <RestConnector Id="PageLookup" Title="Page Lookup">
    <Parameters>
      <Text Id="Id" Title="Id or URL" Debug.DefaultValue="56796081303" Required="true"/>
    </Parameters>
    <Fetch Url="https://graph.facebook.com/v2.8/@(Model.Id)?fields=about,category,checkins,talking_about_count,website,name,likes,fan_count&amp;access_token=@(Model.Authenticator.Token)">
    </Fetch>
    <Parse>
      <JsonPath Title="Page Id" Id="PageId" Expr="$.id" Converter="String" HelpText=""/>
      <JsonPath Title="Title" Id="Title" Expr="$.name" Converter="String" HelpText=""/>
      <JsonPath Title="Category" Id="Category" Expr="$.category" Converter="String" HelpText=""/>
      <JsonPath Title="About" Id="About" Expr="$.about" Converter="String" HelpText=""/>
      <JsonPath Title="Checkins" Id="checkins" Expr="$.checkins" Converter="Int" HelpText=""/>
      <JsonPath Title="Fans" Id="Fans" Expr="$.fan_count" Converter="Int" HelpText=""/>
      <JsonPath Title="Talking About" Id="TalkingAbout" Expr="$.talking_about_count" Converter="Int" HelpText=""/>
      <JsonPath Title="Website" Id="Website" Expr="$.website" Converter="String" HelpText=""/>
			<Compute Id="PageUrl" Title="Page URL">
				<Compute.Expr>
					http://www.facebook.com/@(Model.PageIdInput)
				</Compute.Expr>
				<JsonPath Id="PageIdInput" Expr="id" Converter="String"/>
			</Compute>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AvatarUrl" Title="Avatar URL">
    <Parameters>
      <Text Id="Id" Title="Page or User Id" DefaultValue="" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
				https://graph.facebook.com/@(Model.Id)/?fields=picture&access_token=@(Model.Authenticator.Token)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Title="Avatar URL" Id="AvatarUrl" Expr="$.picture.data.url" Converter="String" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageAlbums" Title="Page Albums">
    <Parameters>
      <Text Id="Id" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="56796081303"/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
				@(Model.Id)/albums?
				fields=count,description,created_time,name
				&access_token=@(Model.Authenticator.Token)
				&limit=@(Model.PageCursor.NextTake)
				@if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Album Id" Id="AlbumId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Title" Id="Title" Expr="name" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Description" Id="Description" Expr="description" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Count" Id="Count" Expr="count" Converter="Int" HelpText=""/>
				<JsonPath Title="Created" Id="Created" Expr="created_time" Converter="DateTime" HelpText=""/>
        <Compute Id="EventUrl" Title="Event URL">
          <Compute.Expr>
            http://www.facebook.com/@(Model.AlbumIdInput)
          </Compute.Expr>
		      <JsonPath Title="Album URL" Id="AlbumIdInput" Expr="id" Converter="String"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageEvents" Title="Page Events">
    <Parameters>
      <Text Id="Id" Title="Id or URL" DefaultValue="" Required="true" Debug.DefaultValue="https://www.facebook.com/DJURGARDEN/?fref=ts"/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/events?
        id=@(Model.Id)
        &access_token=@(Model.Authenticator.Token)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Event Id" Id="EventId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Event" Id="Event" Expr="name" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Description" Id="Description" Expr="description" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Location" Id="Location" Expr="place.name" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Country" Id="Country" Expr="place.location.country" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="City" Id="City" Expr="place.location.city" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Street" Id="Street" Expr="place.location.street" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Start Time" Id="StartTime" Expr="start_time" Converter="DateTime" HelpText="" DefaultValue=" "/>
				<JsonPath Title="End Time" Id="EndTime" Expr="end_time" Converter="DateTime" HelpText="" DefaultValue=" "/>
				<Compute Id="EventUrl" Title="Event URL">
					<Compute.Expr>
						http://www.facebook.com/events/@(Model.EventId)
					</Compute.Expr>
					<JsonPath Title="Event Id" Id="EventId" Expr="id" Converter="String"/>
				</Compute>
			</JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="EventAttendings" Title="Event Attendings">
    <Parameters>
      <Text Id="Id" Title="Id" DefaultValue="" Required="true" Debug.DefaultValue="1620248291609521"/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/
        @(Model.Id)
        /attending?
        &access_token=@(Model.Authenticator.Token)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Id" Id="Id" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Name" Id="Name" Expr="name" Converter="String" HelpText=""/>
				<JsonPath Title="RSVP" Id="Rsvp" Expr="rsvp_status" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageFeed" Title="Page Feed">
    <Parameters>
      <Text Id="Id" Title="Id or URL" DefaultValue="" Required="true" Debug.DefaultValue="https://www.facebook.com/filippak/" HelpText="The feed of posts (including status updates) and links published by this page, or by others on this page."/>
    </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.next"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        @if(Model.PageCursor.Page == 0)
        {
				  @: https://graph.facebook.com/feed?id=@(Model.Id)
				  @: &access_token=@(Model.Authenticator.Token)
					@: &limit=@(Model.PageCursor.NextTake)
				  @: include_hidden=true
				}
				else
        {
          @(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Post Id" Id="PostId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Message" Id="Message" Expr="message" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Story" Id="Story" Expr="story" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Created" Id="Created" Expr="created_time" Converter="DateTime" HelpText=""/>
        <Compute Id="Url" Title="URL">
          <Compute.Expr>
            https://www.facebook.com/@(Model.Id)/
          </Compute.Expr>
          <JsonPath Expr="id" Id="Id" Converter="String"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageVideos" Title="Page Videos">
    <Parameters>
      <Text Id="Id" Title="Video Id" DefaultValue="" Required="true" Debug.DefaultValue="56796081303" HelpText=""/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
		    @(Model.Id)/videos
				?fields=description,created_time,title,source
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Video Id" Id="VideoId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Title" Id="Title" Expr="title" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Description" Id="Description" Expr="description" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Created" Id="Created" Expr="created_time" Converter="DateTime" HelpText=""/>
				<JsonPath Title="Video Link" Id="VideoLink" Expr="source" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PagePhotos" Title="Page Photos">
    <Parameters>
      <Text Id="Id" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="56796081303" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
				@(Model.Id)/photos?
				fields=album,created_time,height,width,link,picture
				&access_token=@(Model.Authenticator.Token)
				&limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Photo Id" Id="PhotoId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Width" Id="Width" Expr="width" Converter="Int" HelpText=""/>
				<JsonPath Title="Height" Id="Height" Expr="height" Converter="Int" HelpText=""/>
				<JsonPath Title="Created" Id="Created" Expr="created_time" Converter="DateTime" HelpText=""/>
				<JsonPath Title="Photo Link" Id="PhotoLink" Expr="link" Converter="String" HelpText=""/>
				<JsonPath Title="Photo Source" Id="PhotoSource" Expr="picture" Converter="String" HelpText=""/>
				<JsonPath Title="Album Id" Id="AlbumId" Expr="album.id" Converter="String" HelpText=""/>
				<JsonPath Title="Album Name" Id="AlbumName" Expr="album.name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostLikers" Title="Post Likers">
    <Parameters>
      <Text Id="Id" Title="Id (Use 'PageId_PostId' Format)" DefaultValue="" Required="true" Debug.DefaultValue="56796081303_10154300423791304" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
		    @(Model.Id)
		    /likes
				?fields=link,name
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="User Id" Id="UserId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="User Name" Id="UserName" Expr="name" Converter="String" HelpText=""/>
				<JsonPath Title="User URL" Id="UserUrl" Expr="link" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostComments" Title="Post Commentators">
    <Parameters>
      <Text Id="Id" Title="Id" DefaultValue="" Required="true" Debug.DefaultValue="56796081303_10154300423791304" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
		    @(Model.Id)
		    /comments?
				fields=comment_count,like_count,created_time,from,message
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Comment Id" Id="CommentId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Comment" Id="Comment" Expr="message" Converter="String" HelpText=""/>
				<JsonPath Title="Likes" Id="Likes" Expr="like_count" Converter="Int" HelpText=""/>
				<JsonPath Title="Comments" Id="Comments" Expr="comment_count" Converter="Int" HelpText=""/>
				<JsonPath Title="Created" Id="Created" Expr="created_time" Converter="DateTime" HelpText=""/>
				<JsonPath Title="User Id" Id="UserId" Expr="from.id" Converter="String" HelpText=""/>
				<JsonPath Title="User Name" Id="UserName" Expr="from.name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message" Converter="String"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostLookup" Title="Post Lookup">
    <Parameters>
      <Text Id="Id" Title="Id (Use 'PageId_PostId' Format)" DefaultValue="" Debug.DefaultValue="56796081303_10154300423791304" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
		    @(Model.Id)
				?fields=shares,likes.summary(true),comments.summary(true),message,type,description,created_time,permalink_url,from,picture,
				reactions.type(LOVE).limit(0).summary(total_count).as(reactions_love),
				reactions.type(WOW).limit(0).summary(total_count).as(reactions_wow),
				reactions.type(HAHA).limit(0).summary(total_count).as(reactions_haha),
				reactions.type(SAD).limit(0).summary(total_count).as(reactions_sad),
				reactions.type(ANGRY).limit(0).summary(total_count).as(reactions_angry)
		    &access_token=@(Model.Authenticator.Token)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.">
				<JsonPath Title="Message" Id="Message" Expr="$.message" Converter="String" HelpText=""  DefaultValue=" "/>
				<JsonPath Title="Likes" Id="Likes" Expr="$.likes.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Comments" Id="Comments" Expr="$.comments.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Love" Id="Love" Expr="$.reactions_love.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Wow" Id="Wow" Expr="$.reactions_wow.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Haha" Id="Haha" Expr="$.reactions_haha.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Sad" Id="Sad" Expr="$.reactions_sad.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Angry" Id="Angry" Expr="$.reactions_angry.summary.total_count" Converter="Int" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Type" Id="Type" Expr="$.type" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Description" Id="Description" Expr="$.description" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Created" Id="Created" Expr="$.created_time" Converter="DateTime" HelpText=""/>
				<JsonPath Title="Shares" Id="Shares" Expr="$.shares.count" Converter="Int" HelpText="" DefaultValue="0"/>
				<JsonPath Title="Author Id" Id="AuthorId" Expr="$.from.id" Converter="String" HelpText=""/>
				<JsonPath Title="Author" Id="Author" Expr="$.from.name" Converter="String" HelpText=""/>
				<JsonPath Title="Image URL" Id="ImageUrl" Expr="$.picture" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Permalink" Id="Permalink" Expr="$.permalink_url" Converter="String" HelpText="" DefaultValue=" "/>
				<JsonPath Title="Picture URL" Id="PictureUrl" Expr="$.picture" Converter="String" HelpText="" DefaultValue=" "/>

			</JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="CommentLookup" Title="Comment Lookup">
    <Parameters>
      <Text Id="Id" Title="Id (Use 'PostId_CommentId' Format)" DefaultValue="" Debug.DefaultValue="1531576806852516_1531721810171349" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
				@(Model.Id)
				?fields=message,from,created_time,like_count,comment_count,permalink_url
		    &access_token=@(Model.Authenticator.Token)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.">
				<JsonPath Title="Message" Id="Message" Expr="$.message" Converter="String" HelpText=""/>
				<JsonPath Title="Likes" Id="Likes" Expr="$.like_count" Converter="Int" HelpText=""/>
				<JsonPath Title="Comments" Id="Comments" Expr="$.comment_count" Converter="Int" HelpText=""/>
				<JsonPath Title="Created" Id="Created" Expr="$.created_time" Converter="DateTime" HelpText=""/>
				<JsonPath Title="Author Id" Id="AuthorId" Expr="$.from.id" Converter="String" HelpText=""/>
				<JsonPath Title="Author" Id="Author" Expr="$.from.name" Converter="String" HelpText=""/>
				<JsonPath Title="Permalink" Id="Permalink" Expr="$.permalink_url" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageSearch" Title="Page Search">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Required="true" Debug.DefaultValue="jultomte" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/search?
		    q=@Utils.UrlEncode(Model.Query)
		    &type=page
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Page Id" Id="PageId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Page Name" Id="PageName" Expr="name" Converter="String" HelpText=""/>
        <Compute Id="PageUrl" Title="Page URL">
          <Compute.Expr>
            http://www.facebook.com/@(Model.PageId)
          </Compute.Expr>
					<JsonPath Title="Page Id" Id="PageId" Expr="id" Converter="String" HelpText=""/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="GroupSearch" Title="Group Search">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Required="true" Debug.DefaultValue="jultomte" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
		<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/search?
		    q=@Utils.UrlEncode(Model.Query)
		    &type=group
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
				<JsonPath Title="Group Id" Id="GroupId" Expr="id" Converter="String" HelpText=""/>
				<JsonPath Title="Group" Id="Group" Expr="name" Converter="String" HelpText=""/>
				<JsonPath Title="Privacy" Id="Privacy" Expr="privacy" Converter="String" HelpText=""/>
			</JsonPath>
			<JsonPath Expr="data.*">
				<Compute Id="GroupUrl" Title="Group URL">
					<Compute.Expr>
						http://www.facebook.com/groups/@(Model.GroupId)
					</Compute.Expr>
					<JsonPath Title="Group Id" Id="GroupId" Expr="id" Converter="String"/>
				</Compute>
			</JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="EventSearch" Title="Event Search">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Required="true" Debug.DefaultValue="jultomte" HelpText=""/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
				<JsonPath Id="Cursor" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/search?
		    q=@Utils.UrlEncode(Model.Query)
		    &type=event
		    &access_token=@(Model.Authenticator.Token)
	      &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@(Model.Cursor)
        }
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
		<JsonPath Title="Event Id" Id="EventId" Expr="id" Converter="String" HelpText=""/>
		<JsonPath Title="Event" Id="Event" Expr="name" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="Description" Id="Description" Expr="description" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="Location" Id="Location" Expr="place.name" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="Country" Id="Country" Expr="place.location.country" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="City" Id="City" Expr="place.location.city" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="Street" Id="Street" Expr="place.location.street" Converter="String" HelpText="" DefaultValue=" "/>
		<JsonPath Title="Start Time" Id="StartTime" Expr="start_time" Converter="DateTime" HelpText="" DefaultValue=" "/>
		<JsonPath Title="End Time" Id="EndTime" Expr="end_time" Converter="DateTime" HelpText="" DefaultValue=" "/>
      </JsonPath>
      <JsonPath Expr="data.*">
        <Compute Id="EventUrl" Title="Event URL">
          <Compute.Expr>
            http://www.facebook.com/events/@(Model.EventId)
          </Compute.Expr>
		      <JsonPath Title="Event Id" Id="EventId" Expr="id" Converter="String"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PersonSearch" Title="Person Search">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Required="true" Debug.DefaultValue="smith" HelpText="Search for a person (if they allow their name to be searched for)."/>
    </Parameters>
    <Paging PageSize="25" EvenPages="false">
      <Parse>
        <JsonPath Id="NextUrl" Expr="paging.next"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/search?
				&access_token=@(Model.Authenticator.Token)
				&q=@Utils.UrlEncode(Model.Query)
				&type=user
				&limit=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
		<JsonPath Title="Person Id" Id="PersonId" Expr="id" Converter="String" HelpText=""/>
		<JsonPath Title="Name" Id="Name" Expr="name" Converter="String" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data.*">
        <Compute Id="PersonUrl" Title="Person URL">
          <Compute.Expr>
            http://www.facebook.com/@(Model.PersonId)
          </Compute.Expr>
		      <JsonPath Title="Person Id" Id="PersonId" Expr="id" Converter="String" HelpText=""/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

</Suite>