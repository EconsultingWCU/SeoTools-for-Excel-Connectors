<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" Title="SimilarWeb" Id="SimilarWeb" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/SimilarWeb.xml" HelpUrl="http://seotoolsforexcel.com/similarweb/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/similarweb/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/similarweb/"/>
  </Settings>

  <RestConnector Id="TotalTraffic" Title="Total Traffic" HelpUrl="https://developer.similarweb.com/estimated_visits_api">
    <Parameters>
      <Text Id="Url" Title="URL" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://api.similarweb.com/v1/website/@(Utils.UrlEncode(Model.Url))/
        total-traffic-and-engagement/visits?
        api_key=@(Model.ApiKey)&main_domain_only=false&granularity=monthly
        &start_date=2016-01&end_date=2016-03
        ]]>
      </Fetch.Url>
    </Fetch>

    <Parse>

    </Parse>
  </RestConnector>
</Suite>