<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Facebook Insights" RequireVersion="6.0.0" Id="FacebookInsights" Category="Social" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/FacebookInsights.xml" HelpUrl="http://seotoolsforexcel.com/FacebookInsights/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/FacebookInsights/">
    <Text Id="AccessToken" Title="Access Token" Required="true" HelpUrl="http://seotoolsforexcel.com/FacebookInsights"/>
  </Settings>

  <RestConnector Id="ListPages" Title="Pages List" Hidden="true">
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/me/accounts?
		  &access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="PageId" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="PageName" Title="Name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListPosts" Hidden="true">
    <Parameters>
      <Text Id="PageId" Title="PageId" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="	" Select.IdField="PageId" Select.TitleField="PageName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/@(Model.PageId)
		  /posts?
		  &access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="PostId" Title="PostId" Converter="String" HelpText=""/>
        <JsonPath Expr="message" Id="PostName" Title="PostName" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListVideos" Hidden="true">
    <Parameters>
      <Text Id="PageId" Title="PageId" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/feed?
		  id=@(Model.PageId)
		  &access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[?(@@.type=='video')]">
        <JsonPath Expr="id" Id="VideoId" Title="VideoId" Converter="String" HelpText=""/>
        <JsonPath Expr="message" Id="VideoName" Title="VideoName" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>
  <RestConnector Id="PageImpressions" Title="Page Impressions">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
		  &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions')].values.*">
        <JsonPath Expr="value" Id="i" Tag="page_impressions" Title="Impressions" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_unique')].values.*">
        <JsonPath Expr="value" Id="iu" Tag="page_impressions_unique" Title="Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_paid')].values.*">
        <JsonPath Expr="value" Id="p" Tag="page_impressions_paid" Title="Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_paid_unique')].values.*">
        <JsonPath Expr="value" Id="pu" Tag="page_impressions_paid_unique" Title="Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_organic')].values.*">
        <JsonPath Expr="value" Id="o" Tag="page_impressions_organic" Title="Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_organic_unique')].values.*">
        <JsonPath Expr="value" Id="ou" Tag="page_impressions_organic_unique" Title="Organic Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_viral')].values.*">
        <JsonPath Expr="value" Id="v" Tag="page_impressions_viral" Title="Viral" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_impressions_viral_unique')].values.*">
        <JsonPath Expr="value" Id="vu" Tag="page_impressions_viral_unique" Title="Viral Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageImpressionsbyStoryType" Title="Page Impressions by Story Type">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Checkbox Id="Unique" Title="Unique Impressions" DefaultValue="False" HelpText="Calculates results for unique impressions."/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  page_impressions_by_story_type
		  @(Model.Unique ? "_unique" : "")
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
		  &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*.values.*">
        <JsonPath Expr="end_time" Id="Date" Title="Date" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="value.fan" Id="Fan" Title="Fan" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.user post" Id="UserPost" Title="User Post" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.page post" Id="PagePost" Title="Page Post" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.checkin" Id="CheckIn" Title="Check-In" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.question" Id="Question" Title="Question" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.coupon" Id="Coupon" Title="Coupon" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.event" Id="Event" Title="Event" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.mention" Id="Mention" Title="Mention" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.other" Id="Other" Title="Other" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageEngagement" Title="Page Engagement">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
		  &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_engaged_users')].values.*">
        <JsonPath Expr="value" Id="eu" Tag="page_engaged_users" Title="Engaged Users" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_consumptions')].values.*">
        <JsonPath Expr="value" Id="uc" Tag="page_consumptions" Title="Clicks On Content" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_places_checkin_total')].values.*">
        <JsonPath Expr="value" Id="c" Tag="page_places_checkin_total" Title="Check-Ins" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_places_checkin_total_unique')].values.*">
        <JsonPath Expr="value" Id="cu" Tag="page_places_checkin_total_unique" Title="Check-Ins Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_places_checkin_mobile')].values.*">
        <JsonPath Expr="value" Id="cm" Tag="page_places_checkin_mobile" Title="Check-Ins Mobile" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_negative_feedback')].values.*">
        <JsonPath Expr="value" Id="nf" Tag="page_negative_feedback" Title="Negative Feedback" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_negative_feedback_unique')].values.*">
        <JsonPath Expr="value" Id="nfu" Tag="page_negative_feedback_unique" Title="Negative Feedback Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageClicksbyType" Title="Page Clicks by Type">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Checkbox Id="Unique" Title="Unique Impressions" DefaultValue="False" HelpText="Calculates results for unique impressions."/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
      https://graph.facebook.com/v2.7/
      @(Model.PageId)
      /insights/
      page_consumptions_by_consumption_type
      @(Model.Unique ? "_unique" : "")
      ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
      &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*.values.*">
        <JsonPath Expr="end_time" Id="Date" Title="Date" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="value.link clicks" Id="LinkClicks" Title="Link Clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.photo view" Id="PhotoViews" Title="Photo Views" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.video play" Id="VideoPlay" Title="Video Plays" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.button clicks" Id="ButtonClicks" Title="Button Clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.other clicks" Id="OtherClicks" Title="Other Clicks" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageStoriesbyStoryType" Title="Page Stories by Type">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
	    https://graph.facebook.com/v2.7/
	    @(Model.PageId)
	    /insights/
	    ,page_stories,page_stories_by_story_type
	    ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
	    &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="Date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_stories')].values.*">
        <JsonPath Expr="value" Id="StoriesTotal" Title="Stories Total" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.fan" Id="PageLikes" Title="Page Likes" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.user post" Id="UserPosts" Title="User Posts" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.page post" Id="PagePosts" Title="Page Posts" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.checkin" Id="CheckIn" Title="Check-In" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.question" Id="Question" Title="Question" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.coupon" Id="Coupon" Title="Coupon" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.event" Id="Event" Title="Event" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.mention" Id="Mention" Title="Mention" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[1].values.*">
        <JsonPath Expr="value.other" Id="Other" Title="Other" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageDailyReactions" Title="Page Daily Reactions">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  page_actions_post_reactions_total
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*.values.*">
        <JsonPath Expr="end_time" Id="Date" Title="Date" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="value.like" Id="Like" Title="Like" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.love" Id="Love" Title="Love" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.wow" Id="Wow" Title="Wow" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.haha" Id="Haha" Title="Haha" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.sorry" Id="Sorry" Title="Sorry" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.anger" Id="Anger" Title="Anger" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageFansDaily" Title="Page Fans Daily">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_fans')].values.*">
        <JsonPath Expr="value" Id="tf" Tag="page_fans" Title="Total Fans" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_fan_adds')].values.*">
        <JsonPath Expr="value" Id="pfa" Tag="page_fan_adds" Title="New Fans" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_fan_adds_unique')].values.*">
        <JsonPath Expr="value" Id="nfu" Tag="page_fan_adds_unique" Title="New Fans Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_fan_removes')].values.*">
        <JsonPath Expr="value" Id="rf" Tag="page_fan_removes" Title="Removed Fans" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_fan_removes_unique')].values.*">
        <JsonPath Expr="value" Id="rfu" Tag="page_fan_removes_unique" Title="Removed Fans Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageViewsbyDevice" Title="Page Views by Device">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  page_views_by_site_logged_in_unique
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
			&period=day
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*.values.*">
        <JsonPath Expr="end_time" Id="Date" Title="Date" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="value.WWW" Id="WWW" Title="WWW" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.MOBILE" Id="Mobile" Title="Mobile" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.API" Id="Api" Title="Api" Converter="Int" HelpText=""/>
        <JsonPath Expr="value.OTHER" Id="Other" Title="Other" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageVideoViews" Title="Page Video Views">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PageId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
		  &period=@(Model.AggregationPeriod)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views')].values.*">
        <JsonPath Expr="value" Id="v" Tag="page_video_views" Title="Views" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views_unique')].values.*">
        <JsonPath Expr="value" Id="vu" Tag="page_video_views_unique" Title="Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views_paid')].values.*">
        <JsonPath Expr="value" Id="p" Tag="page_video_views_paid" Title="Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views_organic')].values.*">
        <JsonPath Expr="value" Id="o" Tag="page_video_views_organic" Title="Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views_autoplayed')].values.*">
        <JsonPath Expr="value" Id="a" Tag="page_video_views_autoplayed" Title="Autoplayed" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_views_click_to_play')].values.*">
        <JsonPath Expr="value" Id="c" Tag="page_video_views_click_to_play" Title="Clicked" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_repeat_views')].values.*">
        <JsonPath Expr="value" Id="r" Tag="page_video_repeat_views" Title="Repeated" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s')].values.*">
        <JsonPath Expr="value" Id="vc" Tag="page_video_complete_views_30s" Title="Views > 30s" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_unique')].values.*">
        <JsonPath Expr="value" Id="vcu" Tag="page_video_complete_views_30s_unique" Title="Views > 30s Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_paid')].values.*">
        <JsonPath Expr="value" Id="vcp" Tag="page_video_complete_views_30s_paid" Title="Views > 30s Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_organic')].values.*">
        <JsonPath Expr="value" Id="vco" Tag="page_video_complete_views_30s_organic" Title="Views > 30s Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_autoplayed')].values.*">
        <JsonPath Expr="value" Id="vca" Tag="page_video_complete_views_30s_autoplayed" Title="Views > 30s Autoplayed" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_click_to_play')].values.*">
        <JsonPath Expr="value" Id="vcc" Tag="page_video_complete_views_30s_click_to_play" Title="Views > 30s Clicked" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_video_complete_views_30s_repeat_views')].values.*">
        <JsonPath Expr="value" Id="vcr" Tag="page_video_complete_views_30s_repeat_views" Title="Views > 30s Repeated" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PagePostImpressions" Title="Page Posts Impressions">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="AggregationPeriod" Title="Aggregation Period" DefaultValue="" Required="true">
        <DataSource>
          <Item Id="day" Title="Daily"/>
          <Item Id="week" Title="Weekly"/>
          <Item Id="days_28" Title="28 Days"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
      https://graph.facebook.com/v2.7/
      @(Model.PageId)
      /insights/
	  @SelectedFields()
      ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
      &period=@(Model.AggregationPeriod)		
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions')].values.*">
        <JsonPath Expr="value" Id="i" Tag="page_posts_impressions" Title="Impressions" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_unique')].values.*">
        <JsonPath Expr="value" Id="iu" Tag="page_posts_impressions_unique" Title="Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_paid')].values.*">
        <JsonPath Expr="value" Id="p" Tag="page_posts_impressions_paid" Title="Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_paid_unique')].values.*">
        <JsonPath Expr="value" Id="pu" Tag="page_posts_impressions_paid_unique" Title="Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_organic')].values.*">
        <JsonPath Expr="value" Id="o" Tag="page_posts_impressions_organic" Title="Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_organic_unique')].values.*">
        <JsonPath Expr="value" Id="ou" Tag="page_posts_impressions_organic_unique" Title="Organic Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_viral')].values.*">
        <JsonPath Expr="value" Id="v" Title="Viral" Tag="page_posts_impressions_viral" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='page_posts_impressions_viral_unique')].values.*">
        <JsonPath Expr="value" Id="vu" Tag="page_posts_impressions_viral_unique" Title="Viral Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostImpressionsLookup" Title="Post Impressions Lookup">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPosts" Select.IdField="PostId" Select.TitleField="PostName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[?(@@.name=='post_impressions')].values.*">
        <JsonPath Expr="value" Id="i" Tag="post_impressions" Title="Impressions" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_unique')].values.*">
        <JsonPath Expr="value" Id="iu" Tag="post_impressions_unique" Title="Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_paid')].values.*">
        <JsonPath Expr="value" Id="p" Title="Paid" Tag="post_impressions_paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_paid_unique')].values.*">
        <JsonPath Expr="value" Id="pu" Tag="post_impressions_paid_unique" Title="Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_fan')].values.*">
        <JsonPath Expr="value" Id="f" Tag="post_impressions_fan" Title="Fan" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_fan_unique')].values.*">
        <JsonPath Expr="value" Id="fu" Tag="post_impressions_fan_unique" Title="Fan Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_fan_paid')].values.*">
        <JsonPath Expr="value" Id="fp" Tag="post_impressions_fan_paid" Title="Fan Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_fan_unique')].values.*">
        <JsonPath Expr="value" Id="fpu" Tag="post_impressions_fan_unique" Title="Fan Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_organic')].values.*">
        <JsonPath Expr="value" Id="o" Tag="post_impressions_organic" Title="Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_organic_unique')].values.*">
        <JsonPath Expr="value" Id="ou" Tag="post_impressions_organic_unique" Title="Organic Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_viral')].values.*">
        <JsonPath Expr="value" Id="v" Tag="post_impressions_viral" Title="Viral" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_impressions_viral_unique')].values.*">
        <JsonPath Expr="value" Id="vu" Tag="post_impressions_viral_unique" Title="Viral Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostEngagementLookup" Title="Post Engagement Lookup">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPosts" Select.IdField="PostId" Select.TitleField="PostName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[?(@@.name=='post_engaged_users')].values.*">
        <JsonPath Expr="value" Id="e" Tag="post_engaged_users" Title="Engagement" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_fan_reach')].values.*">
        <JsonPath Expr="value" Id="fr" Tag="post_fan_reach" Title="Fan Reach" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_consumptions')].values.*">
        <JsonPath Expr="value" Id="c" Tag="post_consumptions" Title="Clicks" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_consumptions_unique')].values.*">
        <JsonPath Expr="value" Id="cu" Tag="post_consumptions_unique" Title="Clicks Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_negative_feedback')].values.*">
        <JsonPath Expr="value" Id="nf" Tag="post_negative_feedback" Title="Negative Feedback" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_negative_feedback_unique')].values.*">
        <JsonPath Expr="value" Id="nfu" Tag="post_negative_feedback_unique" Title="Negative Feedback Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_engaged_fan')].values.*">
        <JsonPath Expr="value" Id="fe" Tag="post_engaged_fan" Title="Fan Engagement" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="VideoLookup" Title="Video Lookup">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListVideos" Select.IdField="VideoId" Select.TitleField="VideoName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  @SelectedFields()
      ?&access_token=@(Model.AccessToken)
		  &period=lifetime
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[?(@@.name=='post_video_length')].values.*">
        <JsonPath Expr="value" Id="vl" Tag="post_video_length" Title="Video Length (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_avg_time_watched')].values.*">
        <JsonPath Expr="value" Id="awt" Tag="post_video_avg_time_watched" Title="Average WatchTime (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_view_time')].values.*">
        <JsonPath Expr="value" Id="twt" Tag="post_video_view_time" Title="Total Watch Time (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_view_time_organic')].values.*">
        <JsonPath Expr="value" Id="twto" Tag="post_video_view_time_organic" Title="Total Watch Time Organic (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views')].values.*">
        <JsonPath Expr="value" Id="v" Tag="post_video_views" Title="Views" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_unique')].values.*">
        <JsonPath Expr="value" Id="u" Tag="post_video_views_unique" Title="Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_10s_unique')].values.*">
        <JsonPath Expr="value" Id="c10s" Tag="post_video_views_10s_unique" Title="Views > 10s" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_sound_on')].values.*">
        <JsonPath Expr="value" Id="so" Tag="post_video_views_sound_on" Title="Sound On" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_autoplayed')].values.*">
        <JsonPath Expr="value" Id="a" Tag="post_video_views_autoplayed" Title="Autoplayed" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_clicked_to_play')].values.*">
        <JsonPath Expr="value" Id="c" Tag="post_video_views_clicked_to_play" Title="Clicked" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_organic')].values.*">
        <JsonPath Expr="value" Id="o" Tag="post_video_views_organic" Title="Organic" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_organic_unique')].values.*">
        <JsonPath Expr="value" Id="ou" Tag="post_video_views_organic_unique" Title="Organic Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_paid')].values.*">
        <JsonPath Expr="value" Id="op" Tag="post_video_views_paid" Title="Organic Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_paid_unique')].values.*">
        <JsonPath Expr="value" Id="opu" Tag="post_video_views_paid_unique" Title="Organic Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_complete_views_organic')].values.*">
        <JsonPath Expr="value" Id="oc" Tag="post_video_complete_views_organic" Title="Organic Complete" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_complete_views_organic_unique')].values.*">
        <JsonPath Expr="value" Id="ocu" Tag="post_video_complete_views_organic_unique" Title="Organic Complete Unique" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_complete_views_paid')].values.*">
        <JsonPath Expr="value" Id="ocp" Tag="post_video_complete_views_paid" Title="Organic Complete Paid" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_complete_views_paid_unique')].values.*">
        <JsonPath Expr="value" Id="ccpu" Tag="post_video_complete_views_paid_unique" Title="Organic Complete Paid Unique" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="VideoLookupDaily" Title="Video Lookup Daily">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListVideos" Select.IdField="VideoId" Select.TitleField="VideoName"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  @SelectedFields()
		  ?&access_token=@(Model.AccessToken)
		  &since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		  &until=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
		  &period=day
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[0].values.*">
        <JsonPath Expr="end_time" Id="date" Title="Date" Converter="DateTime" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views')].values.*">
        <JsonPath Expr="value" Id="views" Tag="post_video_views" Title="Views" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_view_time')].values.*">
        <JsonPath Expr="value" Id="ttw" Tag="post_video_view_time" Title="Total WatchTime (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_view_time_organic')].values.*">
        <JsonPath Expr="value" Id="tto" Tag="post_video_view_time_organic" Title="Total WatchTime Organic (ms)" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_paid')].values.*">
        <JsonPath Expr="value" Id="paid" Tag="post_video_views_paid" Title="Paid"  Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data[?(@@.name=='post_video_views_10s_paid')].values.*">
        <JsonPath Expr="value" Id="paid10s" Tag="post_video_views_10s_paid" Title="Paid > 10s" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostClicksbyType" Title="Post Clicks by Type">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPosts" Select.IdField="PostId" Select.TitleField="PostName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  post_consumptions_by_type_unique
		  ?&access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Regex Expr="&quot;link\s*clicks&quot;:\s*(\d*)" Id="LinkClicks" Title="Link Clicks" Converter="Int" Group="1"/>
			<Regex Expr="&quot;photo\s*view&quot;:\s*(\d*)" Id="PhotoViews" Title="Photo Views" Converter="Int" Group="1"/>
			<Regex Expr="&quot;video\s*play&quot;:\s*(\d*)" Id="VideoPlays" Title="Video Plays" Converter="Int" Group="1"/>
			<Regex Expr="&quot;other\s*clicks&quot;:\s*(\d*)" Id="OtherClicks" Title="Other Clicks" Converter="Int" Group="1"/>	
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PostStoriesbyType" Title="Post Stories by Type">
    <Parameters>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListPages" Select.IdField="PageId" Select.TitleField="PageName"/>
      <Text Id="PostId" Title="Post Id" DefaultValue="" Required="true" Debug.DefaultValue="" Select.Connector="ListPosts" Select.IdField="PostId" Select.TitleField="PostName"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.7/
		  @(Model.PostId)
		  /insights/
		  post_stories_by_action_type
		  ?&access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Regex Expr="&quot;like&quot;:\s*(\d*)" Id="Likes" Title="Likes" Converter="Int" Group="1"/>
			<Regex Expr="&quot;comment&quot;:\s*(\d*)" Id="Comments" Title="Comments" Converter="Int" Group="1"/>
			<Regex Expr="&quot;share&quot;:\s*(\d*)" Id="Shares" Title="Shares" Converter="Int" Group="1"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error.error_user_msg"/>
    </Fail>
  </RestConnector>		

  <RazorFunctions>
    <![CDATA[
      string SelectedFields() {
        string[] fields = ((string)Model.Fields).Split(',').Select(e => e.Trim().ToLower()).ToArray();
        return string.Join(",",((ResultField[])Model.Headers).Where(e => !string.IsNullOrEmpty(e.Tag) && fields.Contains(e.Identifier.ToLower())).Select(e => e.Tag).ToArray());
      }
    ]]>
  </RazorFunctions>

</Suite>