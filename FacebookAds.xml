<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Facebook Ads" RequireVersion="6.0.0" Id="FacebookAds" Category="Social" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/FacebookAds.xml" HelpUrl="http://seotoolsforexcel.com/FacebookAds/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Resources>
    <Resource Id="Sortings">
      <Item Id="impressions" Title="Impressions"/>
      <Item Id="date_start" Title="Date Start"/>
      <Item Id="date_stop" Title="Date Stop"/>
      <Item Id="reach" Title="Reach"/>
      <Item Id="spend" Title="Spent"/>
      <Item Id="clicks" Title="Clicks"/>
      <Item Id="website_clicks" Title="Website Clicks"/>
      <Item Id="app_store_clicks" Title="App Store Clicks"/>
      <Item Id="social_impressions" Title="Social Impressions"/>
      <Item Id="social_reach" Title="Social Reach"/>
      <Item Id="social_clicks" Title="Social Clicks"/>
      <Item Id="total_actions" Title="Actions"/>
      <Item Id="total_action_value" Title="Actions Value"/>
      <Item Id="cost_per_total_action" Title="Cost per Action"/>
      <Item Id="cpc" Title="CPC"/>
      <Item Id="frequency" Title="Frequency"/>
    </Resource>

    <Resource Id="FrequencySortings">
      <Item Id="reach" Title="Reach"/>
      <Item Id="frequency_value" Title="Frequency"/>
    </Resource>

    <Resource Id="Type">
      <Item Id="impression_device" Title="Device"/>
      <Item Id="age" Title="Age"/>
      <Item Id="gender" Title="Gender"/>
      <Item Id="gender,age" Title="Gender/Age"/>
      <Item Id="country" Title="Country"/>
      <Item Id="region" Title="Region"/>
      <Item Id="placement" Title="Placement"/>
      <Item Id="publisher_platform" Title="Publisher Platform"/>
    </Resource>

    <Resource Id="Optimizations">
      <Item Id="NONE" Title="Default"/>
      <Item Id="APP_INSTALLS" Title="App Installs"/>
      <Item Id="BRAND_AWARENESS" Title="Brand Awareness"/>
      <Item Id="CLICKS" Title="Clicks"/>
      <Item Id="ENGAGED_USERS" Title="Engaged Users"/>
      <Item Id="EXTERNAL" Title="External"/>
      <Item Id="EVENT_RESPONSES" Title="Event responses"/>
      <Item Id="IMPRESSIONS" Title="Impressions"/>
      <Item Id="LEAD_GENERATION" Title="Lead Generation"/>
      <Item Id="LINK_CLICKS" Title="Link Clicks"/>
      <Item Id="OFFER_CLAIMS" Title="Offer Claims"/>
      <Item Id="OFFSITE_CONVERSIONS" Title="Offsite Conversions"/>
      <Item Id="PAGE_ENGAGEMENT" Title="Page Engagement"/>
      <Item Id="PAGE_LIKES" Title="Page Likes"/>
      <Item Id="POST_ENGAGEMENT" Title="Post Engagement"/>
      <Item Id="REACH" Title="Reach"/>
      <Item Id="SOCIAL_IMPRESSIONS" Title="Social Impressions"/>
      <Item Id="VIDEO_VIEWS" Title="Video Views"/>
      <Item Id="APP_DOWNLOADS" Title="App Downloads"/>
    </Resource>

    <Resource Id="Platforms">
      <Item Id="default" Title="Default"/>
      <Item Id="facebook" Title="Facebook"/>
      <Item Id="instagram" Title="Instagram"/>
      <Item Id="audience_network" Title="Audience Network"/>
      <Item Id="messenger" Title="Messenger"/>
    </Resource>

    <Resource Id="RelationshipStatuses">
      <Item Id="default" Title="Default"/>
      <Item Id="1" Title="Single"/>
      <Item Id="2" Title="In Relationship"/>
      <Item Id="3" Title="Married"/>
      <Item Id="4" Title="Engaged"/>
      <Item Id="6" Title="Not Specified"/>
      <Item Id="8" Title="In a Civil Union"/>
      <Item Id="8" Title="In a Domestic Partnership"/>
      <Item Id="9" Title="In an Open Relationship"/>
      <Item Id="10" Title="It's Complicated"/>
      <Item Id="11" Title="Separated"/>
      <Item Id="12" Title="Divorced"/>
      <Item Id="13" Title="Widowed"/>
    </Resource>

    <Resource Id="InterestedIns">
      <Item Id="default" Title="Default"/>
      <Item Id="1" Title="Men"/>
      <Item Id="2" Title="Women"/>
      <Item Id="3" Title="Men and Women"/>
      <Item Id="4" Title="Not Specified"/>
    </Resource>

    <Resource Id="EducationStatuses">
      <Item Id="default" Title="Default"/>
      <Item Id="1" Title="High School"/>
      <Item Id="2" Title="Undergrad"/>
      <Item Id="3" Title="Alum"/>
      <Item Id="4" Title="High School Grad"/>
      <Item Id="5" Title="Some College"/>
      <Item Id="6" Title="Associate Degree"/>
      <Item Id="7" Title="In Grad School"/>
      <Item Id="8" Title="Some Grad School"/>
      <Item Id="9" Title="Master Degree"/>
      <Item Id="10" Title="Professional Degree"/>
      <Item Id="11" Title="Doctorate Degree"/>
      <Item Id="12" Title="Unspecified"/>
      <Item Id="13" Title="Some High School"/>
    </Resource>

    <Resource Id="TimeIncrements">
      <Item Id="all_days" Title="All Days"/>
      <Item Id="1" Title="Daily"/>
			<Item Id="7" Title="Weekly"/>
			<Item Id="14" Title="2 Weeks"/>
			<Item Id="monthly" Title="Monthly"/>
    </Resource>		
  </Resources>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/FacebookAds/">
    <Text Id="AccessToken" Title="Access Token" Required="true" HelpUrl="http://seotoolsforexcel.com/FacebookAds"/>
  </Settings>

  <RestConnector Id="ListAccounts" Title="List Accounts" Hidden="false">
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/me/adaccounts?
			  fields=name,account_id,balance
		    &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="account_id" Id="AccountId" Title="Account Id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="balance" Id="Balance" Title="Balance" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListAccountsHidden" Hidden="true">
    <Fetch>
      <Fetch.Url>
      <![CDATA[
		  https://graph.facebook.com/v2.8/me/adaccounts?
		  fields=name,account_id,balance
		  &access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="account_id" Id="AccountId" Title="Account Id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListCampaigns" Title="List Campaigns" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/act_@(Model.AccountId)/campaigns?
			  fields=@SelectedFields()
		    &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="CampaignId" Title="Campaign Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
        <JsonPath Expr="effective_status" Id="Status" Title="Status" Tag="effective_status" Converter="String" HelpText=""/>
        <JsonPath Expr="created_time" Id="Created" Title="Created" Tag="created_time" Converter="DateTime" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListCampaignsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/act_@(Model.AccountId)/campaigns?
		    fields=@SelectedFields()
		    &access_token=@(Model.AccessToken)		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="CampaignId" Title="Campaign Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListAdsets" Title="List Adsets" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="CampaignFilter" Title="Filter by Campaign" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListCampaignsHidden" Select.IdField="CampaignId" Select.TitleField="Name"/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://graph.facebook.com/v2.8/
        @if(Model.CampaignFilter != "")
        {
          @(Model.CampaignFilter)
        }			
        else
        {
          @: act_@(Model.AccountId)
        }	
        /adsets?
        fields=@SelectedFields()
        &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="AdsetId" Title="Adset Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
        <JsonPath Expr="effective_status" Id="Status" Title="Status" Tag="effective_status" Converter="String" HelpText=""/>
        <JsonPath Expr="lifetime_budget" Id="Budget" Title="Budget" Tag="lifetime_budget" Converter="Double" HelpText=""/>
        <JsonPath Expr="budget_remaining" Id="BudgetRemaining" Title="Budget Remaining" Tag="budget_remaining" Converter="Double" HelpText=""/>
        <JsonPath Expr="billing_event" Id="BillingEvent" Title="Billing Event" Tag="billing_event" Converter="String" HelpText=""/>
        <JsonPath Expr="created_time" Id="Created" Title="Created" Tag="created_time" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="end_time" Id="EndTime" Title="End Time" Tag="end_time" Converter="DateTime" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListAdsetsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
			  act_@(Model.AccountId)
			  /adsets?
			  fields=id,name
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="AdsetId" Title="Adset Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListAds" Title="List Ads" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="CampaignFilter" Title="Filter by Campaign" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListCampaignsHidden" Select.IdField="CampaignId" Select.TitleField="Name"/>
      <Text Id="AdsetFilter" Title="Filter by Adset" DefaultValue="" Required="false" Debug.DefaultValue="" Select.Connector="ListAdsetsHidden" Select.IdField="AdsetId" Select.TitleField="Name"/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
        @if(Model.AdsetFilter != "")
        {
          @(Model.AdsetFilter)
        }			
				else if(Model.CampaignFilter != "")
				{
          @(Model.CampaignFilter)
        }
				else				
				{
          @: act_@(Model.AccountId)
        }				
			  /ads?
			  fields=@SelectedFields()
		    &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }		  
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="AdId" Title="Ad Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
        <JsonPath Expr="created_time" Id="Created" Title="Created" Tag="created_time" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="effective_status" Id="Status" Title="Status" Tag="effective_status" Converter="String" HelpText=""/>
        <JsonPath Expr="adset.id" Id="AdsetId" Title="Adset Id" Tag="adset" Converter="String" HelpText=""/>
        <JsonPath Expr="campaign.id" Id="CampaignId" Title="Campaign Id" Tag="campaign" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ListAdsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/act_@(Model.AccountId)
			  /ads?
			  fields=id,name
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="id" Id="AdId" Title="Ad Id" Tag="id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Tag="name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AccountStatistics" Title="Account Statistics" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>			
      <Radio Id="Level" Title="Sub level" DefaultValue="account" Required="false">
        <DataSource>
          <Item Id="none" Title="None"/>
          <Item Id="campaign" Title="Campaign"/>
          <Item Id="adset" Title="Adset"/>
          <Item Id="ad" Title="Ad"/>
        </DataSource>
      </Radio>
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/act_@(Model.AccountId)/insights?
			  fields=@SelectedFields().Substring(2)
			  @if(Model.Level != "none")
			  {
			  @: &level=@(Model.Level)
			  }
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
          &limit=@(Model.PageCursor.NextTake)
          @if(Model.PageCursor.Page != 0)
          {
            @: &after=@Model.NextResults
          }		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <JsonPath Expr="campaign_id" Id="CampaignId" Title="Campaign Id" Converter="String" Tag="campaign_id" HelpText="" Checked="false"/>
        <JsonPath Expr="campaign_name" Id="CampaigName" Title="Campaign Name" Converter="String" Tag="campaign_name" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_id" Id="AdsetId" Title="Adset Id" Converter="String" Tag="adset_id" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_name" Id="AdsetName" Title="Adset Name" Converter="String" Tag="adset_name" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_id" Id="AdId" Title="Ad Id" Converter="String" Tag="ad_id" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_name" Id="AdName" Title="Ad Name" Converter="String" Tag="ad_name" HelpText="" Checked="false"/>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_spend" Id="SocialSpent" Title="Social Spent" Tag="social_spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AccountStatisticsBreakdown" Title="Account Statistics Breakdown" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Select Id="Type" Title="Select Method or Demography" Required="true" DefaultValue="impression_device">
        <DataSource>
          <Resource Id="Type"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>			
			<Select Id="Sort" Title="Sort" Required="false" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="false">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/act_@(Model.AccountId)/insights?
			  fields=@SelectedFields().Substring(3)
			  &breakdowns=@(Model.Type)
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <Compute Id="Category" Title="Category">
          <Compute.Expr>
            <![CDATA[
		        @if(Model.Type == "gender,age")
		        {
			        @(Model.Gender) @: - @(Model.AgeGroup)
		        }
		        else
		        {
			        @(Model.Category)
		        }
            ]]>
          </Compute.Expr>
          <JsonPath Expr="gender" Id="Gender" Converter="String"/>
          <JsonPath Expr="age" Id="AgeGroup" Converter="String"/>
          <JsonPath Expr="@(Model.Type)" Id="Category" Converter="String"/>
        </Compute>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="CampaignStatistics" Title="Campaign Statistics" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>				
      <Text Id="CampaignId" Title="Filter by Campaign Id" DefaultValue="" Required="false" Debug.DefaultValue="6018461710669" Select.Connector="ListCampaignsHidden" Select.IdField="CampaignId" Select.TitleField="Name"/>
      <Radio Id="Level" Title="Sub level for filtered campaign" DefaultValue="none" Required="false">
        <DataSource>
          <Item Id="none" Title="None"/>
          <Item Id="adset" Title="Adset"/>
          <Item Id="ad" Title="Ad"/>
        </DataSource>
      </Radio>
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
			  @if(Model.CampaignId != "")
			  {
			  @(Model.CampaignId)
			  @: /insights?
			  }
			  else
			  {
			  @: act_@(Model.AccountId)
			  @: /insights?level=campaign
			  }
			  &fields=@SelectedFields().Substring(2)
			  @if(Model.Level != "none")
			  {
			  @: &level=@(Model.Level)
			  }			
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }		  
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <JsonPath Expr="campaign_id" Id="CampaignId" Title="Campaign Id" Converter="String" Tag="campaign_id" HelpText="" Checked="true"/>
        <JsonPath Expr="campaign_name" Id="CampaigName" Title="Campaign Name" Converter="String" Tag="campaign_name" HelpText="" Checked="true"/>
        <JsonPath Expr="adset_id" Id="AdsetId" Title="Adset Id" Converter="String" Tag="adset_id" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_name" Id="AdsetName" Title="Adset Name" Converter="String" Tag="adset_name" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_id" Id="AdId" Title="Ad Id" Converter="String" Tag="ad_id" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_name" Id="AdName" Title="Ad Name" Converter="String" Tag="ad_name" HelpText="" Checked="false"/>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_spend" Id="SocialSpent" Title="Social Spent" Tag="social_spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>


  <RestConnector Id="CampaignStatisticsBreakdown" Title="Campaign Statistics Breakdown" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="CampaignId" Title="Campaign Id" DefaultValue="" Required="true" Debug.DefaultValue="6018461710669" Select.Connector="ListCampaignsHidden" Select.IdField="CampaignId" Select.TitleField="Name"/>
      <Select Id="Type" Title="Select Method or Demography" Required="true" DefaultValue="impression_device">
        <DataSource>
          <Resource Id="Type"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>				
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/@(Model.CampaignId)/insights?
			  fields=@SelectedFields().Substring(3)
			  &breakdowns=@(Model.Type)
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <Compute Id="Category" Title="Category">
          <Compute.Expr>
            <![CDATA[
		        @if(Model.Type == "gender,age")
		        {
			        @(Model.Gender) @: - @(Model.AgeGroup)
		        }
		        else
		        {
			        @(Model.Category)
		        }
            ]]>
          </Compute.Expr>
          <JsonPath Expr="gender" Id="Gender" Converter="String"/>
          <JsonPath Expr="age" Id="AgeGroup" Converter="String"/>
          <JsonPath Expr="@(Model.Type)" Id="Category" Converter="String"/>
        </Compute>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdsetStatistics" Title="Adset Statistics" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>				
      <Text Id="AdsetId" Title="Filter by Adset Id" DefaultValue="" Required="false" Debug.DefaultValue="6018461711469" Select.Connector="ListAdsetsHidden" Select.IdField="AdsetId" Select.TitleField="Name"/>
      <Radio Id="Level" Title="Sub level for filtered campaign" DefaultValue="account" Required="false">
        <DataSource>
          <Item Id="none" Title="None"/>
          <Item Id="ad" Title="Ad"/>
        </DataSource>
      </Radio>
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
			  @if(Model.AdsetId != "")
			  {
			  @(Model.AdsetId)
			  @: /insights?
			  }
			  else
			  {
			  @: act_@(Model.AccountId)
			  @: /insights?level=adset
			  }
			  &fields=@SelectedFields().Substring(2)
			  @if(Model.Level != "none")
			  {
			  @: &level=@(Model.Level)
			  }			
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <JsonPath Expr="campaign_id" Id="CampaignId" Title="Campaign Id" Converter="String" Tag="campaign_id" HelpText="" Checked="false"/>
        <JsonPath Expr="campaign_name" Id="CampaigName" Title="Campaign Name" Converter="String" Tag="campaign_name" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_id" Id="AdsetId" Title="Adset Id" Converter="String" Tag="adset_id" HelpText="" Checked="true"/>
        <JsonPath Expr="adset_name" Id="AdsetName" Title="Adset Name" Converter="String" Tag="adset_name" HelpText="" Checked="true"/>
        <JsonPath Expr="ad_id" Id="AdId" Title="Ad Id" Converter="String" Tag="ad_id" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_name" Id="AdName" Title="Ad Name" Converter="String" Tag="ad_name" HelpText="" Checked="false"/>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_spend" Id="SocialSpent" Title="Social Spent" Tag="social_spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdsetStatisticsBreakdown" Title="Adset Statistics Breakdown" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="AdsetId" Title="Adset Id" DefaultValue="" Required="true" Debug.DefaultValue="6018461711469" Select.Connector="ListAdsetsHidden" Select.IdField="AdsetId" Select.TitleField="Name"/>
      <Select Id="Type" Title="Select Method or Demography" Required="true" DefaultValue="impression_device">
        <DataSource>
          <Resource Id="Type"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>				
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/@(Model.AdsetId)/insights?
			  fields=@SelectedFields().Substring(3)
			  &breakdowns=@(Model.Type)
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <Compute Id="Category" Title="Category">
          <Compute.Expr>
            <![CDATA[
		        @if(Model.Type == "gender,age")
		        {
			        @(Model.Gender) @: - @(Model.AgeGroup)
		        }
		        else
		        {
			        @(Model.Category)
		        }
            ]]>
          </Compute.Expr>
          <JsonPath Expr="gender" Id="Gender" Converter="String"/>
          <JsonPath Expr="age" Id="AgeGroup" Converter="String"/>
          <JsonPath Expr="@(Model.Type)" Id="Category" Converter="String"/>
        </Compute>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdStatistics" Title="Ad Statistics" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
				<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>			
      <Text Id="AdId" Title="Filter by Ad Id" DefaultValue="" Required="false" Debug.DefaultValue="6018461712869" Select.Connector="ListAdsHidden" Select.IdField="AdId" Select.TitleField="Name"/>
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
			  @if(Model.AdId != "")
			  {
			  @(Model.AdId)
			  @: /insights?
			  }
			  else
			  {
			  @: act_@(Model.AccountId)
			  @: /insights?level=ad
			  }
			  &fields=@SelectedFields().Substring(2)
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
          &limit=@(Model.PageCursor.NextTake)
          @if(Model.PageCursor.Page != 0)
          {
            @: &after=@Model.NextResults
          }		  
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <JsonPath Expr="campaign_id" Id="CampaignId" Title="Campaign Id" Converter="String" Tag="campaign_id" HelpText="" Checked="false"/>
        <JsonPath Expr="campaign_name" Id="CampaigName" Title="Campaign Name" Converter="String" Tag="campaign_name" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_id" Id="AdsetId" Title="Adset Id" Converter="String" Tag="adset_id" HelpText="" Checked="false"/>
        <JsonPath Expr="adset_name" Id="AdsetName" Title="Adset Name" Converter="String" Tag="adset_name" HelpText="" Checked="false"/>
        <JsonPath Expr="ad_id" Id="AdId" Title="Ad Id" Converter="String" Tag="ad_id" HelpText="" Checked="true"/>
        <JsonPath Expr="ad_name" Id="AdName" Title="Ad Name" Converter="String" Tag="ad_name" HelpText="" Checked="true"/>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_spend" Id="SocialSpent" Title="Social Spent" Tag="social_spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdStatisticsBreakdown" Title="Ad Statistics Breakdown" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="AdId" Title="Ad Id" DefaultValue="" Required="true" Debug.DefaultValue="6018461712869" Select.Connector="ListAdsHidden" Select.IdField="AdId" Select.TitleField="Name"/>
      <Select Id="Type" Title="Select Method or Demography" Required="true" DefaultValue="impression_device">
        <DataSource>
          <Resource Id="Type"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Interval"/>
			<Select Id="PeriodIncrement" Title="Period Increment" Required="false" DefaultValue="all_days">
        <DataSource>
          <Resource Id="TimeIncrements"/>
        </DataSource>
      </Select>				
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="impressions">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/@(Model.AdId)/insights?
			  fields=@SelectedFields().Substring(3)
			  &breakdowns=@(Model.Type)
		    &sort=@(Model.Sort)
			  _
			  @(Model.Direction)			
			  &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			  &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
				&time_increment=@(Model.PeriodIncrement)
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>				
        <Compute Id="Category" Title="Category">
          <Compute.Expr>
            <![CDATA[
		        @if(Model.Type == "gender,age")
		        {
			        @(Model.Gender) @: - @(Model.AgeGroup)
		        }
		        else
		        {
			        @(Model.Category)
		        }
            ]]>
          </Compute.Expr>
          <JsonPath Expr="gender" Id="Gender" Converter="String"/>
          <JsonPath Expr="age" Id="AgeGroup" Converter="String"/>
          <JsonPath Expr="@(Model.Type)" Id="Category" Converter="String"/>
        </Compute>
        <JsonPath Expr="impressions" Id="Impressions" Title="Impressions" Converter="Int" Tag="impressions" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Tag="reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="spend" Id="Spent" Title="Spent" Tag="spend" Converter="Double" HelpText=""/>
        <JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Tag="clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="website_clicks" Id="WebsiteClicks" Title="Website Clicks" Tag="website_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="app_store_clicks" Id="AppStoreClicks" Title="App Store Clicks" Tag="app_store_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_impressions" Id="SocialImpressions" Title="Social Impressions" Tag="social_impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_reach" Id="SocialReach" Title="Social Reach" Tag="social_reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="social_clicks" Id="SocialClicks" Title="Social Clicks" Tag="social_clicks" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_actions" Id="Actions" Title="Actions" Tag="total_actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_action_value" Id="ActionsValue" Title="Actions Value" Tag="total_action_value" Converter="Int" HelpText=""/>
        <JsonPath Expr="cost_per_total_action" Id="CostPerAction" Title="Cost per Action" Tag="cost_per_total_action" Converter="Double" HelpText=""/>
        <JsonPath Expr="cpc" Id="CPC" Title="CPC" Tag="cpc" Converter="Double" HelpText=""/>
        <JsonPath Expr="frequency" Id="Frequency" Title="Frequency" Tag="frequency" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>


  <RestConnector Id="ReachFrequency" Title="Reach Frequency" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
			<Text Id="SubItemFilter" Title="Filter by Id (Campaign, Adset, or Ad)" DefaultValue="" Required="false" Debug.DefaultValue="6018461711469"/>      <DateInterval Id="DateInterval" Title="Interval"/>
      <Select Id="Sort" Title="Sort" Required="true" DefaultValue="reach">
        <DataSource>
          <Resource Id="FrequencySortings"/>
        </DataSource>
      </Select>
      <Radio Id="Direction" Title="Direction" DefaultValue="desc" Required="true">
        <DataSource>
          <Item Id="descending" Title="Descending"/>
          <Item Id="ascending" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		    https://graph.facebook.com/v2.8/
				@if(Model.SubItemFilter == "")
				{
					@: act_@(Model.AccountId)
				}
				else
				{
					@(Model.SubItemFilter)
				}				
				/insights?
		    fields=reach
		    &breakdowns=frequency_value
		    &sort=@(Model.Sort)
		    _
		    @(Model.Direction)			
		    &time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		    &time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
		    &access_token=@(Model.AccessToken)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.*">
        <JsonPath Expr="date_start" Id="DateStart" Title="Date Start" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="date_stop" Id="DateStop" Title="Date Stop" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="frequency_value" Id="Frequency" Title="Frequency" Converter="Int" HelpText=""/>
        <JsonPath Expr="reach" Id="Reach" Title="Reach" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>
	
  <RestConnector Id="AccountReachEstimate" Title="Account Reach Estimate" Hidden="false" HelpText="Use Targeting Search to find key/code/id for filtering.">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Radio Id="Geolevel" Title="Filter Targeting by Geography Level" Required="false">
        <DataSource>
          <Item Id="countries" Title="Country"/>
          <Item Id="cities" Title="City"/>
          <Item Id="regions" Title="Region"/>
        </DataSource>
      </Radio>
      <Text Id="GeoKey" Title="Geography Key/Code" Required="true" Debug.DefaultValue="US"/>
      <Radio Id="LocationType" Title="Location Type" Required="false">
        <DataSource>
          <Item Id="home" Title="Home"/>
          <Item Id="recent" Title="Recent"/>
          <Item Id="travel_in" Title="Travel In"/>
        </DataSource>
      </Radio>
      <Text Id="TargetingMinAge" Title="Min Age" DefaultValue="" Required="true" Debug.DefaultValue="13"/>
      <Text Id="TargetingMaxAge" Title="Max Age" DefaultValue="" Required="true" Debug.DefaultValue="65"/>
      <Radio Id="Gender" Title="Gender" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="1" Title="Male"/>
          <Item Id="2" Title="Female"/>
        </DataSource>
      </Radio>
      <Select Id="EducationStatus" Title="Education Status" Required="false" DefaultValue="default">
        <DataSource>
          <Resource Id="EducationStatuses"/>
        </DataSource>
      </Select>
      <Select Id="RelationshipStatus" Title="Relationship Status" Required="false" DefaultValue="default">
        <DataSource>
          <Resource Id="RelationshipStatuses"/>
        </DataSource>
      </Select>
      <Select Id="InterestedIn" Title="Interested In (not available in EU)" Required="false" DefaultValue="default">
        <DataSource>
          <Resource Id="InterestedIns"/>
        </DataSource>
      </Select>
      <Text Id="Interest" Title="Filter Targeting by Interest Id" DefaultValue="" Required="false" Debug.DefaultValue="6003107902433"/>
      <Select Id="Platform" Title="Publisher Platform" Required="false" DefaultValue="default">
        <DataSource>
          <Resource Id="Platforms"/>
        </DataSource>
      </Select>
      <Radio Id="MobileDevice" Title="Mobile Filter" Required="false">
        <DataSource>
          <Item Id="none" Title="None"/>
          <Item Id="mobile" Title="Mobile"/>
          <Item Id="iOS" Title="iOS"/>
          <Item Id="Android" Title="Android"/>
        </DataSource>
      </Radio>
      <Select Id="Optimization" Title="Optimize for" Required="false" DefaultValue="NONE">
        <DataSource>
          <Resource Id="Optimizations"/>
        </DataSource>
      </Select>
      <Text Id="DailyPlannedBudget" Title="Daily Planned Budget" DefaultValue="" Required="false" Debug.DefaultValue=""/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/act_@(Model.AccountId)/reachestimate?
		  targeting_spec=
		  {
				"geo_locations":
				{
					"@(Model.Geolevel)":
					@if(@Model.Geolevel != "countries")
					{
						@: [{"key":" 
						@(Model.GeoKey)
						@: "}]
					}
					else
					{
						@: ["
						@(Model.GeoKey)
						@: "]
					}
				,"location_types": ["@(Model.LocationType)"]
				},
				@if(@Model.Gender != "all")
				{
					@: "genders": [
					@(Model.Gender) 
					@: ],
				}
				"age_min": @(Model.TargetingMinAge),
				"age_max": @(Model.TargetingMaxAge)
				@if(@Model.MobileDevice == "mobile")
				{
					@: ,"user_os": ["iOS", "Android"]
				}
				else if(@Model.MobileDevice == "iOS" || @Model.MobileDevice == "Android")
				{
					@: ,"user_os": ["
					@(Model.MobileDevice)
					@: "]
				}
				@if(@Model.Platform != "default")				
				{
					@: ,"publisher_platforms": ["
					@(Model.Platform) 
					@: "]
				}
				@if(@Model.Interest != "")				
				{
					@: ,"interests": {"id":
					@(Model.Interest) 
					@: }					
				}
				@if(@Model.RelationshipStatus != "default")				
				{
					@: ,"relationship_statuses": [
					@(Model.RelationshipStatus) 
					@: ]					
				}
				@if(@Model.InterestedIn != "default")				
				{
					@: ,"interested_in": [
					@(Model.InterestedIn) 
					@: ]					
				}
				@if(@Model.EducationStatus != "default")				
				{
					@: ,"education_statuses": [
					@(Model.EducationStatus) 
					@: ]					
				}				
		  }
		  &optimize_for=OFFSITE_CONVERSIONS
			@if(@Model.DailyPlannedBudget != "")				
				{
					@: daily_budget=@(Model.DailyPlannedBudget)				
				}			
		  &optimize_for=OFFSITE_CONVERSIONS			
		  &access_token=@(Model.AccessToken)		  
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.users" Id="Users" Title="Users" Converter="String" HelpText=""/>
      <JsonPath Expr="data.bid_estimations[*]">
        <JsonPath Expr="account_budget" Id="AccountBudget" Title="Account Budget" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data.bid_estimations[*].curve[*]">
        <JsonPath Expr="bid" Id="Bid" Title="Bid" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.spend" Id="OverallSpent" Title="Overall Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="overall_point.reach" Id="OverallReach" Title="Overall Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.impressions" Id="OverallImpressions" Title="Overall Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.actions" Id="OverallActions" Title="Overall Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.spend" Id="HomefeedSpent" Title="Homefeed Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="home_feed_point.reach" Id="HomefeedReach" Title="Homefeed Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.impressions" Id="HomefeedImpressions" Title="Homefeed Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.actions" Id="HomefeedActions" Title="Homefeed Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.spend" Id="MobilefeedSpent" Title="Mobilefeed Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.reach" Id="MobilefeedReach" Title="Mobilefeed Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.impressions" Id="MobilefeedImpressions" Title="Mobilefeed Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.actions" Id="MobilefeedActions" Title="Mobilefeed Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.spend" Id="InstagramSpent" Title="Instagram Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="instagram_point.reach" Id="InstagramReach" Title="Instagram Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.impressions" Id="Instagrammpressions" Title="Instagram Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.actions" Id="InstagramActions" Title="Instagram Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.spend" Id="RHCSpent" Title="RHC Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="rhc_point.reach" Id="RHCeach" Title="RHC Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.impressions" Id="RHCmpressions" Title="RHC Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.actions" Id="RHCActions" Title="RHC Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.spend" Id="AudienceNetworkSpent" Title="Audience Network Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="audience_network_point.reach" Id="AudienceNetworkReach" Title="Audience Network Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.impressions" Id="AudienceNetworkImpressions" Title="Audience Network Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.actions" Id="AudienceNetworkActions" Title="Audience Network Actions" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data.bid_estimations[*]">
        <JsonPath Expr="bid_amount_min" Id="MinBidAmount" Title="MinBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="bid_amount_median" Id="MedBidAmount" Title="MedBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="bid_amount_max" Id="MaxBidAmount" Title="MaxBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="reach_min" Id="MinReach" Title="MinReach" Converter="Int" HelpText=""/>
        <JsonPath Expr="reach_max" Id="MaxReach" Title="MaxReach" Converter="Int" HelpText=""/>
        <JsonPath Expr="dedup_winning_rate" Id="DedupWinRate" Title="Dedup Winrate" Converter="Int" HelpText=""/>
        <JsonPath Expr="dedup_status" Id="DedupStatus" Title="Dedup Status" Converter="Int" HelpText=""/>
        <JsonPath Expr="pacing_status" Id="PacingStatus" Title="Pacing Status" Converter="Int" HelpText=""/>
        <JsonPath Expr="estimate_DAU" Id="EstimatedDAU" Title="Estimated DAU" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdReachEstimate" Title="Ad Reach Estimate" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="AdId" Title="Ad Id" DefaultValue="" Required="true" Debug.DefaultValue="6018461712869" Select.Connector="ListAdsHidden" Select.IdField="AdId" Select.TitleField="Name"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/@(Model.AdId)/reachestimate?
		  &access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data.users" Id="Users" Title="Users" Converter="Int" HelpText=""/>
      <JsonPath Expr="data.bid_estimations[*]">
        <JsonPath Expr="account_budget" Id="AccountBudget" Title="Account Budget" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data.bid_estimations[*].curve[*]">
        <JsonPath Expr="bid" Id="Bid" Title="Bid" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.spend" Id="OverallSpent" Title="Overall Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="overall_point.reach" Id="OverallReach" Title="Overall Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.impressions" Id="OverallImpressions" Title="Overall Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="overall_point.actions" Id="OverallActions" Title="Overall Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.spend" Id="HomefeedSpent" Title="Homefeed Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="home_feed_point.reach" Id="HomefeedReach" Title="Homefeed Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.impressions" Id="HomefeedImpressions" Title="Homefeed Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="home_feed_point.actions" Id="HomefeedActions" Title="Homefeed Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.spend" Id="MobilefeedSpent" Title="Mobilefeed Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.reach" Id="MobilefeedReach" Title="Mobilefeed Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.impressions" Id="MobilefeedImpressions" Title="Mobilefeed Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="mobile_feed_point.actions" Id="MobilefeedActions" Title="Mobilefeed Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.spend" Id="InstagramSpent" Title="Instagram Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="instagram_point.reach" Id="InstagramReach" Title="Instagram Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.impressions" Id="Instagrammpressions" Title="Instagram Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="instagram_point.actions" Id="InstagramActions" Title="Instagram Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.spend" Id="RHCSpent" Title="RHC Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="rhc_point.reach" Id="RHCeach" Title="RHC Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.impressions" Id="RHCmpressions" Title="RHC Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="rhc_point.actions" Id="RHCActions" Title="RHC Actions" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.spend" Id="AudienceNetworkSpent" Title="Audience Network Spent" Converter="Double" HelpText=""/>
        <JsonPath Expr="audience_network_point.reach" Id="AudienceNetworkReach" Title="Audience Network Reach" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.impressions" Id="AudienceNetworkImpressions" Title="Audience Network Impressions" Converter="Int" HelpText=""/>
        <JsonPath Expr="audience_network_point.actions" Id="AudienceNetworkActions" Title="Audience Network Actions" Converter="Int" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="data.bid_estimations[*]">
        <JsonPath Expr="bid_amount_min" Id="MinBidAmount" Title="MinBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="bid_amount_median" Id="MedBidAmount" Title="MedBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="bid_amount_max" Id="MaxBidAmount" Title="MaxBid Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="reach_min" Id="MinReach" Title="MinReach" Converter="Int" HelpText=""/>
        <JsonPath Expr="reach_max" Id="MaxReach" Title="MaxReach" Converter="Int" HelpText=""/>
        <JsonPath Expr="dedup_winning_rate" Id="DedupWinRate" Title="Dedup Winrate" Converter="Int" HelpText=""/>
        <JsonPath Expr="dedup_status" Id="DedupStatus" Title="Dedup Status" Converter="Int" HelpText=""/>
        <JsonPath Expr="pacing_status" Id="PacingStatus" Title="Pacing Status" Converter="Int" HelpText=""/>
        <JsonPath Expr="estimate_DAU" Id="EstimatedDAU" Title="Estimated DAU" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AccountActivities" Title="Account Activities" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
	    https://graph.facebook.com/v2.8/act_@(Model.AccountId)/activities?
		&fields=@SelectedFields()
		&access_token=@(Model.AccessToken)
		&since=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
		&until=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))			
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[*]">
        <JsonPath Expr="event_time" Id="Time" Title="Time" Tag="event_time" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="translated_event_type" Id="Event" Title="Event" Tag="translated_event_type" Converter="String" HelpText=""/>
        <JsonPath Expr="actor_name" Id="User" Title="User" Tag="actor_name" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AccountUsers" Title="List Account Users" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/act_@(Model.AccountId)/users?
		&access_token=@(Model.AccessToken)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[*]">
        <JsonPath Expr="id" Id="UserId" Title="User Id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <Compute Id="Role" Title="Role">
          <Compute.Expr>
            <![CDATA[
		@if(Model.RoleInput == 1001)
		{
			@: Administrator
		}
		else if(Model.RoleInput == 1002)
		{
			@: Advertiser
		}
		else if(Model.RoleInput == 1003)
		{
			@: Analyst access
		}
		else if(Model.RoleInput == 1004)
		{
			@: Direct sales access
		}
		else
		{
			@: Other
		}					
        ]]>
          </Compute.Expr>
          <JsonPath Expr="role" Id="RoleInput" Converter="Int"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ActionsBreakdown" Title="Actions Breakdown" Hidden="false">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Required="true" Debug.DefaultValue="10153745413391289" Select.Connector="ListAccountsHidden" Select.IdField="AccountId" Select.TitleField="Name"/>
      <Text Id="SubItemFilter" Title="Filter by Id (Campaign, Adset, or Ad)" DefaultValue="" Required="false" Debug.DefaultValue="6018461711469"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Unique" Title="Action Type" DefaultValue="actions" Required="true">
        <DataSource>
          <Item Id="actions" Title="Total"/>
          <Item Id="unique_actions" Title="Unique"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/
			@if(Model.SubItemFilter == "")
			{
				@: act_@(Model.AccountId)
			}
			else
			{
				@(Model.SubItemFilter)
			}
			/insights?
			fields=@(Model.Unique)
			&access_token=@(Model.AccessToken)
			&time_range[since]=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
			&time_range[until]=@(Model.DateInterval.EndDate.ToString("yyyy-MM-dd"))
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$..@(Model.Unique).*">
        <JsonPath Expr="action_type" Id="Type" Title="Type" Converter="String" HelpText=""/>
        <JsonPath Expr="value" Id="Actions" Title="Actions" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="TargetingGeographyCodeSearch" Title="Targeting Geography Code Search" Hidden="false">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Debug.DefaultValue="Stockholm" Required="true"/>
      <Radio Id="LocationType" Title="Location Type" Required="false">
        <DataSource>
          <Item Id="country" Title="Country"/>
          <Item Id="city" Title="City"/>
          <Item Id="region" Title="Region"/>
          <Item Id="zip" Title="Zip Code"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/
			search?type=adgeolocation
			&q=@Utils.UrlEncode(Model.Query)
			&location_types=["@(Model.LocationType)"]
			&access_token=@(Model.AccessToken)
      &limit=@(Model.PageCursor.NextTake)
      @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }			
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[*]">
        <JsonPath Expr="key" Id="Key" Title="Key" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String" HelpText=""/>
        <JsonPath Expr="country_code" Id="CountryCode" Title="Country Code" Converter="String" HelpText=""/>
        <JsonPath Expr="country_name" Id="CountryName" Title="Country Name" Converter="String" HelpText=""/>
        <JsonPath Expr="region_id" Id="RegionId" Title="Region Id" Converter="Int" HelpText="" Checked="false"/>
        <JsonPath Expr="region" Id="Region" Title="Region" Converter="String" HelpText="" Checked="false"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="TargetingInterestIdSearch" Title="Targeting Interest Id Search" Hidden="false">
    <Parameters>
      <Text Id="Query" Title="Query" DefaultValue="" Debug.DefaultValue="fotboll" Required="true"/>
    </Parameters>
    <Paging PageSize="25">
      <Parse>
        <JsonPath Id="NextResults" Expr="paging.cursors.after"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
		  https://graph.facebook.com/v2.8/
			search?type=adinterest
			&q=@Utils.UrlEncode(Model.Query)
			&access_token=@(Model.AccessToken)
      &limit=@(Model.PageCursor.NextTake)
      @if(Model.PageCursor.Page != 0)
        {
          @: &after=@Model.NextResults
        }			
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="data[*]">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="audience_size" Id="AudienceSize" Title="Audience Size" Converter="String" HelpText=""/>
        <JsonPath Expr="topic" Id="Topic" Title="Topic" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>	
	
  <RazorFunctions>
    <![CDATA[
      string SelectedFields() {
        string[] fields = ((string)Model.Fields).Split(',').Select(e => e.Trim().ToLower()).ToArray();
        return string.Join(",",((ResultField[])Model.Headers).Where(e => fields.Contains(e.Identifier.ToLower())).Select(e => e.Tag).ToArray());
      }
    ]]>
  </RazorFunctions>

</Suite>