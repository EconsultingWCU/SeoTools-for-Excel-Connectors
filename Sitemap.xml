<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Sitemap" Id="Sitemap" Category="Scraping" RequireVersion="8.2" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Sitemap.xml" HelpUrl="http://seotoolsforexcel.com/sitemap/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <RestConnector Id="Sitemap" Ttle="Sitemap">
    <Parameters>
      <Text Id="Url" Title="Stemap URL(s)" Debug.DefaultValue="https://www.aftonbladet.se/sitemaps/files/201207-articles.xml" Multiline="true"/>
    </Parameters>
		<Batch Parameter="Url" Separator="\n"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        @Model.Url
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <XPath Expr="//loc">
				<Compute Expr="@Model.Url" Id="Input" HelpText="Sitemap Input URL."/>
				<XPath Expr="." Id="Url" DefaultValue="" HelpText="URL of the page."/>
				<XPath Expr="../lastmod" Id="Modified" Converter="Auto" DefaultValue="" HelpText="The date of last modification of the file."/>
				<XPath Expr="../changefreq" Id="Frequency" Converter="Auto" DefaultValue="" HelpText="How frequently the page is likely to change."/>
				<XPath Expr="../priority" Id="Priority" Converter="Auto" DefaultValue="" HelpText="The priority of this URL relative to other URLs on your site."/>
			</XPath>
    </Parse>
			<Fail>
				<XPath Expr="//loc" Id="InvalidSitemap" Fail.If="IsEmpty" Fail.Action="Message" Fail.Message="Not a valid Sitemap XML"/>
			</Fail>
  </RestConnector>

</Suite>