<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Off-Page Metrics" Id="Offpage" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/_Offpage.xml" HelpUrl="http://seotoolsforexcel.com/connectors-offpage/" HelpText="Documentation">

  <RestConnector Id="GoogleResults" Title="Google Results" AvailableInSpider="false" HelpText="Scrape number of search results on Google.">
    <Parameters>
      <Text Id="Query" Title="Query" Required="true"/>
      <Text Id="Site" Title="Googe Site" DefaultValue="google.com" Required="true"/>
    </Parameters>
    <Fetch Url="http://www.@(Model.Site)/search?hl=en&amp;safe=off&amp;q=@(Utils.UrlEncode(Model.Query))&amp;btnG=Search">
      <HttpSettings>
        <IntervalBetweenRequests RandomFrom="4000" RandomTo="5000" IfSame="Host"/>
        <RequestHeaders>
          <Header Name='User-Agent'>Google Chrome/36</Header>
        </RequestHeaders>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Regex Expr="&lt;div[^&gt;]*id=\&quot;resultStats\&quot;[^&gt;]*&gt;[^\d&lt;&gt;]*([\d,]+)" IgnoreCase="true" Converter="Int"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="GoogleIndex" Title="Google Index" AvailableInSpider="false" HelpText="Scrape number of indexed pages with url on Google through query &quot;site:&lt;url&gt;&quot;.">
    <Parameters>
      <Text Id="Url" Title="URL" Required="true"/>
      <Text Id="Site" Title="Google Site" DefaultValue="google.com" Required="true"/>
    </Parameters>
    <Fetch Url="http://www.@(Model.Site)/search?hl=en&amp;safe=off&amp;q=site%3A@(Utils.UrlEncode(Model.Url))&amp;btnG=Search">
      <HttpSettings>
        <IntervalBetweenRequests RandomFrom="4000" RandomTo="5000" IfSame="Host"/>
        <RequestHeaders>
          <Header Name='User-Agent'>Google Chrome/36</Header>
        </RequestHeaders>
      </HttpSettings>
    </Fetch>
    <Parse>
      <Regex Expr="&lt;div[^&gt;]*id=\&quot;resultStats\&quot;[^&gt;]*&gt;[^\d&lt;&gt;]*([\d,]+)" IgnoreCase="true" Converter="Int"/>
    </Parse>
  </RestConnector>

</Suite>